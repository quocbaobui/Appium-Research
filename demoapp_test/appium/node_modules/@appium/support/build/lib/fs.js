"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.fs = exports.default = void 0;

require("source-map-support/register");

var _bluebird = _interopRequireDefault(require("bluebird"));

var _crypto = _interopRequireDefault(require("crypto"));

var _fs = require("fs");

var _glob = _interopRequireDefault(require("glob"));

var _klaw = _interopRequireDefault(require("klaw"));

var _lodash = _interopRequireDefault(require("lodash"));

var _mv = _interopRequireDefault(require("mv"));

var _ncp = _interopRequireDefault(require("ncp"));

var _path = _interopRequireDefault(require("path"));

var _pkgDir = _interopRequireDefault(require("pkg-dir"));

var _readPkg = _interopRequireDefault(require("read-pkg"));

var _rimraf = _interopRequireDefault(require("rimraf"));

var _sanitizeFilename = _interopRequireDefault(require("sanitize-filename"));

var _which = _interopRequireDefault(require("which"));

var _logger = _interopRequireDefault(require("./logger"));

var _timing = _interopRequireDefault(require("./timing"));

var _util = require("./util");

const ncpAsync = _bluebird.default.promisify(_ncp.default);

const findRootCached = _lodash.default.memoize(_pkgDir.default.sync);

const fs = {
  async hasAccess(path) {
    try {
      await _fs.promises.access(path, _fs.constants.R_OK);
    } catch (err) {
      return false;
    }

    return true;
  },

  async exists(path) {
    return await fs.hasAccess(path);
  },

  rimraf: _bluebird.default.promisify(_rimraf.default),
  rimrafSync: _rimraf.default.sync,

  async mkdir(filepath, opts = {}) {
    try {
      return await _fs.promises.mkdir(filepath, opts);
    } catch (err) {
      if ((err === null || err === void 0 ? void 0 : err.code) !== 'EEXIST') {
        throw err;
      }
    }
  },

  async copyFile(source, destination, opts = {}) {
    if (!(await fs.hasAccess(source))) {
      throw new Error(`The file at '${source}' does not exist or is not accessible`);
    }

    return await ncpAsync(source, destination, opts);
  },

  async md5(filePath) {
    return await fs.hash(filePath, 'md5');
  },

  mv: _bluebird.default.promisify(_mv.default),
  which: _which.default,
  glob: _bluebird.default.promisify(_glob.default),
  sanitizeName: _sanitizeFilename.default,

  async hash(filePath, algorithm = 'sha1') {
    return await new _bluebird.default((resolve, reject) => {
      const fileHash = _crypto.default.createHash(algorithm);

      const readStream = (0, _fs.createReadStream)(filePath);
      readStream.on('error', e => reject(new Error(`Cannot calculate ${algorithm} hash for '${filePath}'. Original error: ${e.message}`)));
      readStream.on('data', chunk => fileHash.update(chunk));
      readStream.on('end', () => resolve(fileHash.digest('hex')));
    });
  },

  walk(dir, opts) {
    return (0, _klaw.default)(dir, opts);
  },

  async mkdirp(dir) {
    return await fs.mkdir(dir, {
      recursive: true
    });
  },

  async walkDir(dir, recursive, callback) {
    let isValidRoot = false;
    let errMsg = null;

    try {
      isValidRoot = (await fs.stat(dir)).isDirectory();
    } catch (e) {
      errMsg = e.message;
    }

    if (!isValidRoot) {
      throw Error(`'${dir}' is not a valid root directory` + (errMsg ? `. Original error: ${errMsg}` : ''));
    }

    let walker;
    let fileCount = 0;
    let directoryCount = 0;
    const timer = new _timing.default().start();
    return await new _bluebird.default(function (resolve, reject) {
      let lastFileProcessed = _bluebird.default.resolve();

      walker = (0, _klaw.default)(dir, {
        depthLimit: recursive ? -1 : 0
      });
      walker.on('data', function (item) {
        walker.pause();

        if (!item.stats.isDirectory()) {
          fileCount++;
        } else {
          directoryCount++;
        }

        lastFileProcessed = _bluebird.default.try(async () => await callback(item.path, item.stats.isDirectory())).then(function (done = false) {
          if (done) {
            resolve(item.path);
          } else {
            walker.resume();
          }
        }).catch(reject);
      }).on('error', function (err, item) {
        _logger.default.warn(`Got an error while walking '${item.path}': ${err.message}`);

        if (err.code === 'ENOENT') {
          _logger.default.warn('All files may not have been accessed');

          reject(err);
        }
      }).on('end', function () {
        lastFileProcessed.then(file => {
          resolve(file ?? null);
        }).catch(function (err) {
          _logger.default.warn(`Unexpected error: ${err.message}`);

          reject(err);
        });
      });
    }).finally(function () {
      _logger.default.debug(`Traversed ${(0, _util.pluralize)('directory', directoryCount, true)} ` + `and ${(0, _util.pluralize)('file', fileCount, true)} ` + `in ${timer.getDuration().asMilliSeconds.toFixed(0)}ms`);

      if (walker) {
        walker.destroy();
      }
    });
  },

  readPackageJsonFrom(dir, opts = {}) {
    const cwd = fs.findRoot(dir);

    try {
      return _readPkg.default.sync({ ...opts,
        cwd
      });
    } catch (err) {
      err.message = `Failed to read a \`package.json\` from dir \`${dir}\`:\n\n${err.message}`;
      throw err;
    }
  },

  findRoot(dir) {
    if (!dir || !_path.default.isAbsolute(dir)) {
      throw new TypeError('`findRoot()` must be provided a non-empty, absolute path');
    }

    const result = findRootCached(dir);

    if (!result) {
      throw new Error(`\`findRoot()\` could not find \`package.json\` from ${dir}`);
    }

    return result;
  },

  access: _fs.promises.access,
  appendFile: _fs.promises.appendFile,
  chmod: _fs.promises.chmod,
  close: _bluebird.default.promisify(_fs.close),
  constants: _fs.constants,
  createWriteStream: _fs.createWriteStream,
  createReadStream: _fs.createReadStream,
  lstat: _fs.promises.lstat,
  open: _bluebird.default.promisify(_fs.open),
  openFile: _fs.promises.open,
  readdir: _fs.promises.readdir,
  read: _bluebird.default.promisify(_fs.read),
  readFile: _fs.promises.readFile,
  readlink: _fs.promises.readlink,
  realpath: _fs.promises.realpath,
  rename: _fs.promises.rename,
  stat: _fs.promises.stat,
  symlink: _fs.promises.symlink,
  unlink: _fs.promises.unlink,
  write: _bluebird.default.promisify(_fs.write),
  writeFile: _fs.promises.writeFile,
  F_OK: _fs.constants.F_OK,
  R_OK: _fs.constants.R_OK,
  W_OK: _fs.constants.W_OK,
  X_OK: _fs.constants.X_OK
};
exports.fs = fs;
var _default = fs;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJuY3BBc3luYyIsIkIiLCJwcm9taXNpZnkiLCJuY3AiLCJmaW5kUm9vdENhY2hlZCIsIl8iLCJtZW1vaXplIiwicGtnRGlyIiwic3luYyIsImZzIiwiaGFzQWNjZXNzIiwicGF0aCIsImZzUHJvbWlzZXMiLCJhY2Nlc3MiLCJjb25zdGFudHMiLCJSX09LIiwiZXJyIiwiZXhpc3RzIiwicmltcmFmIiwicmltcmFmSWR4IiwicmltcmFmU3luYyIsIm1rZGlyIiwiZmlsZXBhdGgiLCJvcHRzIiwiY29kZSIsImNvcHlGaWxlIiwic291cmNlIiwiZGVzdGluYXRpb24iLCJFcnJvciIsIm1kNSIsImZpbGVQYXRoIiwiaGFzaCIsIm12Iiwid2hpY2giLCJnbG9iIiwic2FuaXRpemVOYW1lIiwic2FuaXRpemUiLCJhbGdvcml0aG0iLCJyZXNvbHZlIiwicmVqZWN0IiwiZmlsZUhhc2giLCJjcnlwdG8iLCJjcmVhdGVIYXNoIiwicmVhZFN0cmVhbSIsImNyZWF0ZVJlYWRTdHJlYW0iLCJvbiIsImUiLCJtZXNzYWdlIiwiY2h1bmsiLCJ1cGRhdGUiLCJkaWdlc3QiLCJ3YWxrIiwiZGlyIiwia2xhdyIsIm1rZGlycCIsInJlY3Vyc2l2ZSIsIndhbGtEaXIiLCJjYWxsYmFjayIsImlzVmFsaWRSb290IiwiZXJyTXNnIiwic3RhdCIsImlzRGlyZWN0b3J5Iiwid2Fsa2VyIiwiZmlsZUNvdW50IiwiZGlyZWN0b3J5Q291bnQiLCJ0aW1lciIsIlRpbWVyIiwic3RhcnQiLCJsYXN0RmlsZVByb2Nlc3NlZCIsImRlcHRoTGltaXQiLCJpdGVtIiwicGF1c2UiLCJzdGF0cyIsInRyeSIsInRoZW4iLCJkb25lIiwicmVzdW1lIiwiY2F0Y2giLCJsb2ciLCJ3YXJuIiwiZmlsZSIsImZpbmFsbHkiLCJkZWJ1ZyIsInBsdXJhbGl6ZSIsImdldER1cmF0aW9uIiwiYXNNaWxsaVNlY29uZHMiLCJ0b0ZpeGVkIiwiZGVzdHJveSIsInJlYWRQYWNrYWdlSnNvbkZyb20iLCJjd2QiLCJmaW5kUm9vdCIsInJlYWRQa2ciLCJpc0Fic29sdXRlIiwiVHlwZUVycm9yIiwicmVzdWx0IiwiYXBwZW5kRmlsZSIsImNobW9kIiwiY2xvc2UiLCJjcmVhdGVXcml0ZVN0cmVhbSIsImxzdGF0Iiwib3BlbiIsIm9wZW5GaWxlIiwicmVhZGRpciIsInJlYWQiLCJyZWFkRmlsZSIsInJlYWRsaW5rIiwicmVhbHBhdGgiLCJyZW5hbWUiLCJzeW1saW5rIiwidW5saW5rIiwid3JpdGUiLCJ3cml0ZUZpbGUiLCJGX09LIiwiV19PSyIsIlhfT0siXSwic291cmNlcyI6WyIuLi8uLi9saWIvZnMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQHRzLWNoZWNrXG5cbmltcG9ydCBCIGZyb20gJ2JsdWViaXJkJztcbmltcG9ydCBjcnlwdG8gZnJvbSAnY3J5cHRvJztcbmltcG9ydCB7XG4gIGNsb3NlLFxuICBjb25zdGFudHMsXG4gIGNyZWF0ZVJlYWRTdHJlYW0sXG4gIGNyZWF0ZVdyaXRlU3RyZWFtLFxuICBwcm9taXNlcyBhcyBmc1Byb21pc2VzLFxuICByZWFkLFxuICB3cml0ZSxcbiAgb3Blbixcbn0gZnJvbSAnZnMnO1xuaW1wb3J0IGdsb2IgZnJvbSAnZ2xvYic7XG5pbXBvcnQga2xhdyBmcm9tICdrbGF3JztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgbXYgZnJvbSAnbXYnO1xuaW1wb3J0IG5jcCBmcm9tICduY3AnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgcGtnRGlyIGZyb20gJ3BrZy1kaXInO1xuaW1wb3J0IHJlYWRQa2cgZnJvbSAncmVhZC1wa2cnO1xuaW1wb3J0IHJpbXJhZklkeCBmcm9tICdyaW1yYWYnO1xuaW1wb3J0IHNhbml0aXplIGZyb20gJ3Nhbml0aXplLWZpbGVuYW1lJztcbmltcG9ydCB3aGljaCBmcm9tICd3aGljaCc7XG5pbXBvcnQgbG9nIGZyb20gJy4vbG9nZ2VyJztcbmltcG9ydCBUaW1lciBmcm9tICcuL3RpbWluZyc7XG5pbXBvcnQge3BsdXJhbGl6ZX0gZnJvbSAnLi91dGlsJztcblxuY29uc3QgbmNwQXN5bmMgPVxuICAvKiogQHR5cGUgeyhzb3VyY2U6IHN0cmluZywgZGVzdDogc3RyaW5nLCBvcHRzOiBuY3AuT3B0aW9uc3x1bmRlZmluZWQpID0+IEI8dm9pZD59ICovIChcbiAgICBCLnByb21pc2lmeShuY3ApXG4gICk7XG5jb25zdCBmaW5kUm9vdENhY2hlZCA9IF8ubWVtb2l6ZShwa2dEaXIuc3luYyk7XG5cbmNvbnN0IGZzID0ge1xuICAvKipcbiAgICogUmVzb2x2ZXMgYHRydWVgIGlmIGBwYXRoYCBpcyBfcmVhZGFibGVfLCB3aGljaCBkaWZmZXJzIGZyb20gTm9kZS5qcycgZGVmYXVsdCBiZWhhdmlvciBvZiBcImNhbiB3ZSBzZWUgaXQ/XCJcbiAgICogQHBhcmFtIHtpbXBvcnQoJ2ZzJykuUGF0aExpa2V9IHBhdGhcbiAgICogQHJldHVybnMge1Byb21pc2U8Ym9vbGVhbj59XG4gICAqL1xuICBhc3luYyBoYXNBY2Nlc3MocGF0aCkge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBmc1Byb21pc2VzLmFjY2VzcyhwYXRoLCBjb25zdGFudHMuUl9PSyk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9LFxuXG4gIC8qKlxuICAgKiBBbGlhcyBmb3Ige0BsaW5rY29kZSBmcy5oYXNBY2Nlc3N9XG4gICAqIEBwYXJhbSB7aW1wb3J0KCdmcycpLlBhdGhMaWtlfSBwYXRoXG4gICAqL1xuICBhc3luYyBleGlzdHMocGF0aCkge1xuICAgIHJldHVybiBhd2FpdCBmcy5oYXNBY2Nlc3MocGF0aCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFJlbW92ZSBhIGRpcmVjdG9yeSBhbmQgYWxsIGl0cyBjb250ZW50cywgcmVjdXJzaXZlbHlcbiAgICogQHRvZG8gUmVwbGFjZSB3aXRoIGBybSgpYCBmcm9tIGBmcy5wcm9taXNlc2Agd2hlbiBOb2RlLmpzIHYxMiBzdXBwb3J0IGlzIGRyb3BwZWQuXG4gICAqL1xuICByaW1yYWY6IC8qKiBAdHlwZSB7KGRpcnBhdGg6IHN0cmluZywgb3B0cz86IGltcG9ydCgncmltcmFmJykuT3B0aW9ucykgPT4gUHJvbWlzZTx2b2lkPn0gKi8gKFxuICAgIEIucHJvbWlzaWZ5KHJpbXJhZklkeClcbiAgKSxcblxuICAvKipcbiAgICogQWxpYXMgb2Yge0BsaW5rY29kZSByaW1yYWZJZHguc3luY31cbiAgICogQHRvZG8gUmVwbGFjZSB3aXRoIGBybVN5bmMoKWAgZnJvbSBgZnNgIHdoZW4gTm9kZS5qcyB2MTIgc3VwcG9ydCBpcyBkcm9wcGVkLlxuICAgKi9cbiAgcmltcmFmU3luYzogcmltcmFmSWR4LnN5bmMsXG5cbiAgLyoqXG4gICAqIExpa2UgTm9kZS5qcycgYGZzUHJvbWlzZXMubWtkaXIoKWAsIGJ1dCB3aWxsIF9ub3RfIHJlamVjdCBpZiB0aGUgZGlyZWN0b3J5IGFscmVhZHkgZXhpc3RzLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ3xCdWZmZXJ8VVJMfSBmaWxlcGF0aFxuICAgKiBAcGFyYW0ge2ltcG9ydCgnZnMnKS5NYWtlRGlyZWN0b3J5T3B0aW9uc30gW29wdHNdXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPHN0cmluZ3x1bmRlZmluZWQ+fVxuICAgKiBAc2VlIGh0dHBzOi8vbm9kZWpzLm9yZy9hcGkvZnMuaHRtbCNmc3Byb21pc2VzbWtkaXJwYXRoLW9wdGlvbnNcbiAgICovXG4gIGFzeW5jIG1rZGlyKGZpbGVwYXRoLCBvcHRzID0ge30pIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IGZzUHJvbWlzZXMubWtkaXIoZmlsZXBhdGgsIG9wdHMpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgaWYgKGVycj8uY29kZSAhPT0gJ0VFWElTVCcpIHtcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgLyoqXG4gICAqIENvcGllcyBmaWxlcyBfYW5kIGVudGlyZSBkaXJlY3Rvcmllc19cbiAgICogQHBhcmFtIHtzdHJpbmd9IHNvdXJjZSAtIFNvdXJjZSB0byBjb3B5XG4gICAqIEBwYXJhbSB7c3RyaW5nfSBkZXN0aW5hdGlvbiAtIERlc3RpbmF0aW9uIHRvIGNvcHkgdG9cbiAgICogQHBhcmFtIHtuY3AuT3B0aW9uc30gW29wdHNdIC0gQWRkaXRpb25hbCBhcmd1bWVudHMgdG8gcGFzcyB0byBgbmNwYFxuICAgKiBAc2VlIGh0dHBzOi8vbnBtLmltL25jcFxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTx2b2lkPn1cbiAgICovXG4gIGFzeW5jIGNvcHlGaWxlKHNvdXJjZSwgZGVzdGluYXRpb24sIG9wdHMgPSB7fSkge1xuICAgIGlmICghKGF3YWl0IGZzLmhhc0FjY2Vzcyhzb3VyY2UpKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgZmlsZSBhdCAnJHtzb3VyY2V9JyBkb2VzIG5vdCBleGlzdCBvciBpcyBub3QgYWNjZXNzaWJsZWApO1xuICAgIH1cbiAgICByZXR1cm4gYXdhaXQgbmNwQXN5bmMoc291cmNlLCBkZXN0aW5hdGlvbiwgb3B0cyk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIENyZWF0ZSBhbiBNRDUgaGFzaCBvZiBhIGZpbGUuXG4gICAqIEBwYXJhbSB7aW1wb3J0KCdmcycpLlBhdGhMaWtlfSBmaWxlUGF0aFxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxzdHJpbmc+fVxuICAgKi9cbiAgYXN5bmMgbWQ1KGZpbGVQYXRoKSB7XG4gICAgcmV0dXJuIGF3YWl0IGZzLmhhc2goZmlsZVBhdGgsICdtZDUnKTtcbiAgfSxcblxuICAvKipcbiAgICogTW92ZSBhIGZpbGVcbiAgICovXG4gIG12OiAvKiogQHR5cGUgeyhmcm9tOiBzdHJpbmcsIHRvOiBzdHJpbmcsIG9wdHM/OiBtdi5PcHRpb25zKSA9PiBCPHZvaWQ+fSAqLyAoQi5wcm9taXNpZnkobXYpKSxcblxuICAvKipcbiAgICogRmluZCBwYXRoIHRvIGFuIGV4ZWN1dGFibGUgaW4gc3lzdGVtIGBQQVRIYFxuICAgKiBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ucG0vbm9kZS13aGljaFxuICAgKi9cbiAgd2hpY2gsXG5cbiAgLyoqXG4gICAqIEdpdmVuIGEgZ2xvYiBwYXR0ZXJuLCByZXNvbHZlIHdpdGggbGlzdCBvZiBmaWxlcyBtYXRjaGluZyB0aGF0IHBhdHRlcm5cbiAgICogQHNlZSBodHRwczovL2dpdGh1Yi5jb20vaXNhYWNzL25vZGUtZ2xvYlxuICAgKi9cbiAgZ2xvYjogLyoqIEB0eXBlIHsocGF0dGVybjogc3RyaW5nLCBvcHRzPzogZ2xvYi5JT3B0aW9ucykgPT4gQjxzdHJpbmdbXT59ICovIChCLnByb21pc2lmeShnbG9iKSksXG5cbiAgLyoqXG4gICAqIFNhbml0aXplIGEgZmlsZW5hbWVcbiAgICogQHNlZSBodHRwczovL2dpdGh1Yi5jb20vcGFyc2hhcC9ub2RlLXNhbml0aXplLWZpbGVuYW1lXG4gICAqL1xuICBzYW5pdGl6ZU5hbWU6IHNhbml0aXplLFxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSBoZXggZGlnZXN0IG9mIHNvbWUgZmlsZSBhdCBgZmlsZVBhdGhgXG4gICAqIEBwYXJhbSB7aW1wb3J0KCdmcycpLlBhdGhMaWtlfSBmaWxlUGF0aFxuICAgKiBAcGFyYW0ge3N0cmluZ30gW2FsZ29yaXRobV1cbiAgICogQHJldHVybnMge1Byb21pc2U8c3RyaW5nPn1cbiAgICovXG4gIGFzeW5jIGhhc2goZmlsZVBhdGgsIGFsZ29yaXRobSA9ICdzaGExJykge1xuICAgIHJldHVybiBhd2FpdCBuZXcgQigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBjb25zdCBmaWxlSGFzaCA9IGNyeXB0by5jcmVhdGVIYXNoKGFsZ29yaXRobSk7XG4gICAgICBjb25zdCByZWFkU3RyZWFtID0gY3JlYXRlUmVhZFN0cmVhbShmaWxlUGF0aCk7XG4gICAgICByZWFkU3RyZWFtLm9uKCdlcnJvcicsIChlKSA9PlxuICAgICAgICByZWplY3QoXG4gICAgICAgICAgbmV3IEVycm9yKFxuICAgICAgICAgICAgYENhbm5vdCBjYWxjdWxhdGUgJHthbGdvcml0aG19IGhhc2ggZm9yICcke2ZpbGVQYXRofScuIE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gXG4gICAgICAgICAgKVxuICAgICAgICApXG4gICAgICApO1xuICAgICAgcmVhZFN0cmVhbS5vbignZGF0YScsIChjaHVuaykgPT4gZmlsZUhhc2gudXBkYXRlKGNodW5rKSk7XG4gICAgICByZWFkU3RyZWFtLm9uKCdlbmQnLCAoKSA9PiByZXNvbHZlKGZpbGVIYXNoLmRpZ2VzdCgnaGV4JykpKTtcbiAgICB9KTtcbiAgfSxcblxuICAvKipcbiAgICogUmV0dXJucyBhbiBgV2Fsa2VyYCBpbnN0YW5jZSwgd2hpY2ggaXMgYSByZWFkYWJsZSBzdHJlYW0gKGFuZCB0aHVzbHkgYW4gYXN5bmMgaXRlcmF0b3IpLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZGlyIC0gRGlyIHRvIHN0YXJ0IHdhbGtpbmcgYXRcbiAgICogQHBhcmFtIHtpbXBvcnQoJ2tsYXcnKS5PcHRpb25zfSBbb3B0c11cbiAgICogQHJldHVybnMge2ltcG9ydCgna2xhdycpLldhbGtlcn1cbiAgICogQHNlZSBodHRwczovL3d3dy5ucG1qcy5jb20vcGFja2FnZS9rbGF3XG4gICAqL1xuICB3YWxrKGRpciwgb3B0cykge1xuICAgIHJldHVybiBrbGF3KGRpciwgb3B0cyk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFJlY3Vyc2l2ZWx5IGNyZWF0ZSBhIGRpcmVjdG9yeS5cbiAgICogQHBhcmFtIHtpbXBvcnQoJ2ZzJykuUGF0aExpa2V9IGRpclxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxzdHJpbmd8dW5kZWZpbmVkPn1cbiAgICovXG4gIGFzeW5jIG1rZGlycChkaXIpIHtcbiAgICByZXR1cm4gYXdhaXQgZnMubWtkaXIoZGlyLCB7cmVjdXJzaXZlOiB0cnVlfSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFdhbGtzIGEgZGlyZWN0b3J5IGdpdmVuIGFjY29yZGluZyB0byB0aGUgcGFyYW1ldGVycyBnaXZlbi4gVGhlIGNhbGxiYWNrIHdpbGwgYmUgaW52b2tlZCB3aXRoIGEgcGF0aCBqb2luZWQgd2l0aCB0aGUgZGlyIHBhcmFtZXRlclxuICAgKiBAcGFyYW0ge3N0cmluZ30gZGlyIERpcmVjdG9yeSBwYXRoIHdoZXJlIHdlIHdpbGwgc3RhcnQgd2Fsa2luZ1xuICAgKiBAcGFyYW0ge2Jvb2xlYW59IHJlY3Vyc2l2ZSBTZXQgaXQgdG8gdHJ1ZSBpZiB5b3Ugd2FudCB0byBjb250aW51ZSB3YWxraW5nIHN1YiBkaXJlY3Rvcmllc1xuICAgKiBAcGFyYW0ge1dhbGtEaXJDYWxsYmFja30gY2FsbGJhY2sgVGhlIGNhbGxiYWNrIHRvIGJlIGNhbGxlZCB3aGVuIGEgbmV3IHBhdGggaXMgZm91bmRcbiAgICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBgZGlyYCBwYXJhbWV0ZXIgY29udGFpbnMgYSBwYXRoIHRvIGFuIGludmFsaWQgZm9sZGVyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPHN0cmluZz8+fSByZXR1cm5zIHRoZSBmb3VuZCBwYXRoIG9yIG51bGwgaWYgdGhlIGl0ZW0gd2FzIG5vdCBmb3VuZFxuICAgKi9cbiAgYXN5bmMgd2Fsa0RpcihkaXIsIHJlY3Vyc2l2ZSwgY2FsbGJhY2spIHtcbiAgICAvL2VzbGludC1kaXNhYmxlLWxpbmUgcHJvbWlzZS9wcmVmZXItYXdhaXQtdG8tY2FsbGJhY2tzXG4gICAgbGV0IGlzVmFsaWRSb290ID0gZmFsc2U7XG4gICAgbGV0IGVyck1zZyA9IG51bGw7XG4gICAgdHJ5IHtcbiAgICAgIGlzVmFsaWRSb290ID0gKGF3YWl0IGZzLnN0YXQoZGlyKSkuaXNEaXJlY3RvcnkoKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBlcnJNc2cgPSBlLm1lc3NhZ2U7XG4gICAgfVxuICAgIGlmICghaXNWYWxpZFJvb3QpIHtcbiAgICAgIHRocm93IEVycm9yKFxuICAgICAgICBgJyR7ZGlyfScgaXMgbm90IGEgdmFsaWQgcm9vdCBkaXJlY3RvcnlgICsgKGVyck1zZyA/IGAuIE9yaWdpbmFsIGVycm9yOiAke2Vyck1zZ31gIDogJycpXG4gICAgICApO1xuICAgIH1cblxuICAgIGxldCB3YWxrZXI7XG4gICAgbGV0IGZpbGVDb3VudCA9IDA7XG4gICAgbGV0IGRpcmVjdG9yeUNvdW50ID0gMDtcbiAgICBjb25zdCB0aW1lciA9IG5ldyBUaW1lcigpLnN0YXJ0KCk7XG4gICAgcmV0dXJuIGF3YWl0IG5ldyBCKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIGxldCBsYXN0RmlsZVByb2Nlc3NlZCA9IEIucmVzb2x2ZSgpO1xuICAgICAgd2Fsa2VyID0ga2xhdyhkaXIsIHtcbiAgICAgICAgZGVwdGhMaW1pdDogcmVjdXJzaXZlID8gLTEgOiAwLFxuICAgICAgfSk7XG4gICAgICB3YWxrZXJcbiAgICAgICAgLm9uKCdkYXRhJywgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICB3YWxrZXIucGF1c2UoKTtcblxuICAgICAgICAgIGlmICghaXRlbS5zdGF0cy5pc0RpcmVjdG9yeSgpKSB7XG4gICAgICAgICAgICBmaWxlQ291bnQrKztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGlyZWN0b3J5Q291bnQrKztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJvbWlzZS9wcmVmZXItYXdhaXQtdG8tY2FsbGJhY2tzXG4gICAgICAgICAgbGFzdEZpbGVQcm9jZXNzZWQgPSBCLnRyeShhc3luYyAoKSA9PiBhd2FpdCBjYWxsYmFjayhpdGVtLnBhdGgsIGl0ZW0uc3RhdHMuaXNEaXJlY3RvcnkoKSkpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZG9uZSA9IGZhbHNlKSB7XG4gICAgICAgICAgICAgIGlmIChkb25lKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShpdGVtLnBhdGgpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHdhbGtlci5yZXN1bWUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChyZWplY3QpO1xuICAgICAgICB9KVxuICAgICAgICAub24oJ2Vycm9yJywgZnVuY3Rpb24gKGVyciwgaXRlbSkge1xuICAgICAgICAgIGxvZy53YXJuKGBHb3QgYW4gZXJyb3Igd2hpbGUgd2Fsa2luZyAnJHtpdGVtLnBhdGh9JzogJHtlcnIubWVzc2FnZX1gKTtcbiAgICAgICAgICAvLyBrbGF3IGNhbm5vdCBnZXQgYmFjayBmcm9tIGFuIEVOT0VOVCBlcnJvclxuICAgICAgICAgIGlmIChlcnIuY29kZSA9PT0gJ0VOT0VOVCcpIHtcbiAgICAgICAgICAgIGxvZy53YXJuKCdBbGwgZmlsZXMgbWF5IG5vdCBoYXZlIGJlZW4gYWNjZXNzZWQnKTtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLm9uKCdlbmQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgbGFzdEZpbGVQcm9jZXNzZWRcbiAgICAgICAgICAgIC50aGVuKChmaWxlKSA9PiB7XG4gICAgICAgICAgICAgIHJlc29sdmUoLyoqIEB0eXBlIHtzdHJpbmd8dW5kZWZpbmVkfSAqLyAoZmlsZSkgPz8gbnVsbCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgbG9nLndhcm4oYFVuZXhwZWN0ZWQgZXJyb3I6ICR7ZXJyLm1lc3NhZ2V9YCk7XG4gICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkge1xuICAgICAgbG9nLmRlYnVnKFxuICAgICAgICBgVHJhdmVyc2VkICR7cGx1cmFsaXplKCdkaXJlY3RvcnknLCBkaXJlY3RvcnlDb3VudCwgdHJ1ZSl9IGAgK1xuICAgICAgICAgIGBhbmQgJHtwbHVyYWxpemUoJ2ZpbGUnLCBmaWxlQ291bnQsIHRydWUpfSBgICtcbiAgICAgICAgICBgaW4gJHt0aW1lci5nZXREdXJhdGlvbigpLmFzTWlsbGlTZWNvbmRzLnRvRml4ZWQoMCl9bXNgXG4gICAgICApO1xuICAgICAgaWYgKHdhbGtlcikge1xuICAgICAgICB3YWxrZXIuZGVzdHJveSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9LFxuICAvKipcbiAgICogUmVhZHMgdGhlIGNsb3Nlc3QgYHBhY2thZ2UuanNvbmAgZmlsZSBmcm9tIGFic29sdXRlIHBhdGggYGRpcmAuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBkaXIgLSBEaXJlY3RvcnkgdG8gc2VhcmNoIGZyb21cbiAgICogQHBhcmFtIHtpbXBvcnQoJ3JlYWQtcGtnJykuT3B0aW9uc30gW29wdHNdIC0gQWRkaXRpb25hbCBvcHRpb25zIGZvciBgcmVhZC1wa2dgXG4gICAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGVyZSB3ZXJlIHByb2JsZW1zIGZpbmRpbmcgb3IgcmVhZGluZyBhIGBwYWNrYWdlLmpzb25gIGZpbGVcbiAgICogQHJldHVybnMge29iamVjdH0gQSBwYXJzZWQgYHBhY2thZ2UuanNvbmBcbiAgICovXG4gIHJlYWRQYWNrYWdlSnNvbkZyb20oZGlyLCBvcHRzID0ge30pIHtcbiAgICBjb25zdCBjd2QgPSBmcy5maW5kUm9vdChkaXIpO1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gcmVhZFBrZy5zeW5jKHsuLi5vcHRzLCBjd2R9KTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGVyci5tZXNzYWdlID0gYEZhaWxlZCB0byByZWFkIGEgXFxgcGFja2FnZS5qc29uXFxgIGZyb20gZGlyIFxcYCR7ZGlyfVxcYDpcXG5cXG4ke2Vyci5tZXNzYWdlfWA7XG4gICAgICB0aHJvdyBlcnI7XG4gICAgfVxuICB9LFxuICAvKipcbiAgICogRmluZHMgdGhlIHByb2plY3Qgcm9vdCBkaXJlY3RvcnkgZnJvbSBgZGlyYC5cbiAgICogQHBhcmFtIHtzdHJpbmd9IGRpciAtIERpcmVjdG9yeSB0byBzZWFyY2ggZnJvbVxuICAgKiBAdGhyb3dzIHtUeXBlRXJyb3J9IElmIGBkaXJgIGlzIG5vdCBhIG5vbmVtcHR5IHN0cmluZyBvciByZWxhdGl2ZSBwYXRoXG4gICAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGVyZSB3ZXJlIHByb2JsZW1zIGZpbmRpbmcgdGhlIHByb2plY3Qgcm9vdFxuICAgKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgY2xvc2VzZXQgcGFyZW50IGRpciBjb250YWluaW5nIGBwYWNrYWdlLmpzb25gXG4gICAqL1xuICBmaW5kUm9vdChkaXIpIHtcbiAgICBpZiAoIWRpciB8fCAhcGF0aC5pc0Fic29sdXRlKGRpcikpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2BmaW5kUm9vdCgpYCBtdXN0IGJlIHByb3ZpZGVkIGEgbm9uLWVtcHR5LCBhYnNvbHV0ZSBwYXRoJyk7XG4gICAgfVxuICAgIGNvbnN0IHJlc3VsdCA9IGZpbmRSb290Q2FjaGVkKGRpcik7XG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgXFxgZmluZFJvb3QoKVxcYCBjb3VsZCBub3QgZmluZCBcXGBwYWNrYWdlLmpzb25cXGAgZnJvbSAke2Rpcn1gKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfSxcblxuICAvLyBhZGQgdGhlIHN1cHBvcnRlZCBgZnNgIGZ1bmN0aW9uc1xuICBhY2Nlc3M6IGZzUHJvbWlzZXMuYWNjZXNzLFxuICBhcHBlbmRGaWxlOiBmc1Byb21pc2VzLmFwcGVuZEZpbGUsXG4gIGNobW9kOiBmc1Byb21pc2VzLmNobW9kLFxuICBjbG9zZTogQi5wcm9taXNpZnkoY2xvc2UpLFxuICBjb25zdGFudHMsXG4gIGNyZWF0ZVdyaXRlU3RyZWFtLFxuICBjcmVhdGVSZWFkU3RyZWFtLFxuICBsc3RhdDogZnNQcm9taXNlcy5sc3RhdCxcbiAgLyoqXG4gICAqIFdhcm5pbmc6IHRoaXMgaXMgYSBwcm9taXNpZmllZCB7QGxpbmtjb2RlIG9wZW4gZnMub3Blbn0uXG4gICAqIEl0IHJlc29sdmVzIHcvYSBmaWxlIGRlc2NyaXB0b3IgaW5zdGVhZCBvZiBhIHtAbGlua2NvZGUgZnNQcm9taXNlcy5GaWxlSGFuZGxlIEZpbGVIYW5kbGV9IG9iamVjdCwgYXMge0BsaW5rY29kZSBmc1Byb21pc2VzLm9wZW59IGRvZXMuIFVzZSB7QGxpbmtjb2RlIGZzLm9wZW5GaWxlfSBpZiB5b3Ugd2FudCBhIGBGaWxlSGFuZGxlYC5cbiAgICogQHR5cGUgeyhwYXRoOiBpbXBvcnQoJ2ZzJykuUGF0aExpa2UsIGZsYWdzOiBpbXBvcnQoJ2ZzJykuT3Blbk1vZGUsIG1vZGU/OiBpbXBvcnQoJ2ZzJykuTW9kZSkgPT4gUHJvbWlzZTxudW1iZXI+fVxuICAgKi9cbiAgb3BlbjogQi5wcm9taXNpZnkob3BlbiksXG4gIG9wZW5GaWxlOiBmc1Byb21pc2VzLm9wZW4sXG4gIHJlYWRkaXI6IGZzUHJvbWlzZXMucmVhZGRpcixcbiAgcmVhZDogQi5wcm9taXNpZnkocmVhZCksXG4gIHJlYWRGaWxlOiBmc1Byb21pc2VzLnJlYWRGaWxlLFxuICByZWFkbGluazogZnNQcm9taXNlcy5yZWFkbGluayxcbiAgcmVhbHBhdGg6IGZzUHJvbWlzZXMucmVhbHBhdGgsXG4gIHJlbmFtZTogZnNQcm9taXNlcy5yZW5hbWUsXG4gIHN0YXQ6IGZzUHJvbWlzZXMuc3RhdCxcbiAgc3ltbGluazogZnNQcm9taXNlcy5zeW1saW5rLFxuICB1bmxpbms6IGZzUHJvbWlzZXMudW5saW5rLFxuICB3cml0ZTogQi5wcm9taXNpZnkod3JpdGUpLFxuICB3cml0ZUZpbGU6IGZzUHJvbWlzZXMud3JpdGVGaWxlLFxuXG4gIC8vIGRlcHJlY2F0ZWQgcHJvcHNcblxuICAvKipcbiAgICogVXNlIGBjb25zdGFudHMuRl9PS2AgaW5zdGVhZC5cbiAgICogQGRlcHJlY2F0ZWRcbiAgICovXG4gIEZfT0s6IGNvbnN0YW50cy5GX09LLFxuXG4gIC8qKlxuICAgKiBVc2UgYGNvbnN0YW50cy5SX09LYCBpbnN0ZWFkLlxuICAgKiBAZGVwcmVjYXRlZFxuICAgKi9cbiAgUl9PSzogY29uc3RhbnRzLlJfT0ssXG5cbiAgLyoqXG4gICAqIFVzZSBgY29uc3RhbnRzLldfT0tgIGluc3RlYWQuXG4gICAqIEBkZXByZWNhdGVkXG4gICAqL1xuICBXX09LOiBjb25zdGFudHMuV19PSyxcblxuICAvKipcbiAgICogVXNlIGBjb25zdGFudHMuWF9PS2AgaW5zdGVhZC5cbiAgICogQGRlcHJlY2F0ZWRcbiAgICovXG4gIFhfT0s6IGNvbnN0YW50cy5YX09LLFxufTtcblxuZXhwb3J0IHtmc307XG5leHBvcnQgZGVmYXVsdCBmcztcblxuLyoqXG4gKiBUaGUgY2FsbGJhY2sgZnVuY3Rpb24gd2hpY2ggd2lsbCBiZSBjYWxsZWQgZHVyaW5nIHRoZSBkaXJlY3Rvcnkgd2Fsa2luZ1xuICogQGNhbGxiYWNrIFdhbGtEaXJDYWxsYmFja1xuICogQHBhcmFtIHtzdHJpbmd9IGl0ZW1QYXRoIFRoZSBwYXRoIG9mIHRoZSBmaWxlIG9yIGZvbGRlclxuICogQHBhcmFtIHtib29sZWFufSBpc0RpcmVjdG9yeSBTaG93cyBpZiBpdCBpcyBhIGRpcmVjdG9yeSBvciBhIGZpbGVcbiAqIEByZXR1cm4ge2Jvb2xlYW59IHJldHVybiB0cnVlIGlmIHlvdSB3YW50IHRvIHN0b3Agd2Fsa2luZ1xuICovXG5cbi8qKlxuICogQHR5cGVkZWYge2ltcG9ydCgnZ2xvYicpfSBnbG9iXG4gKiBAdHlwZWRlZiB7aW1wb3J0KCdtdicpfSBtdlxuICovXG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBVUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUEsTUFBTUEsUUFBUSxHQUVWQyxpQkFBQSxDQUFFQyxTQUFGLENBQVlDLFlBQVosQ0FGSjs7QUFJQSxNQUFNQyxjQUFjLEdB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
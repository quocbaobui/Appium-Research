"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.SETTINGS_HELPER_PKG_ID = exports.APP_STATE = void 0;
exports.ensureNetworkSpeed = ensureNetworkSpeed;
exports.helpers = void 0;
exports.prepareAvdArgs = prepareAvdArgs;

require("source-map-support/register");

var _lodash = _interopRequireDefault(require("lodash"));

var _path = _interopRequireDefault(require("path"));

var _asyncbox = require("asyncbox");

var _logger = _interopRequireDefault(require("./logger"));

var _support = require("appium/support");

var _ioAppium = require("io.appium.settings");

var _bootstrap = _interopRequireDefault(require("./bootstrap"));

var _bluebird = _interopRequireDefault(require("bluebird"));

var _appiumAdb = _interopRequireDefault(require("appium-adb"));

var _unlockHelpers = _interopRequireWildcard(require("./unlock-helpers"));

var _os = require("os");

var _semver = _interopRequireDefault(require("semver"));

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

const MOCK_APP_IDS_STORE = '/data/local/tmp/mock_apps.json';
const PACKAGE_INSTALL_TIMEOUT = 90000;
const CHROME_BROWSER_PACKAGE_ACTIVITY = {
  chrome: {
    pkg: 'com.android.chrome',
    activity: 'com.google.android.apps.chrome.Main'
  },
  chromium: {
    pkg: 'org.chromium.chrome.shell',
    activity: '.ChromeShellActivity'
  },
  chromebeta: {
    pkg: 'com.chrome.beta',
    activity: 'com.google.android.apps.chrome.Main'
  },
  browser: {
    pkg: 'com.android.browser',
    activity: 'com.android.browser.BrowserActivity'
  },
  'chromium-browser': {
    pkg: 'org.chromium.chrome',
    activity: 'com.google.android.apps.chrome.Main'
  },
  'chromium-webview': {
    pkg: 'org.chromium.webview_shell',
    activity: 'org.chromium.webview_shell.WebViewBrowserActivity'
  },
  default: {
    pkg: 'com.android.chrome',
    activity: 'com.google.android.apps.chrome.Main'
  }
};
const SETTINGS_HELPER_PKG_ID = 'io.appium.settings';
exports.SETTINGS_HELPER_PKG_ID = SETTINGS_HELPER_PKG_ID;
const SETTINGS_HELPER_UNLOCK_ACTIVITY = '.Unlock';
const EMULATOR_PATTERN = /\bemulator\b/i;
const APP_STATE = Object.freeze({
  NOT_INSTALLED: 0,
  NOT_RUNNING: 1,
  RUNNING_IN_BACKGROUND: 3,
  RUNNING_IN_FOREGROUND: 4
});
exports.APP_STATE = APP_STATE;

function ensureNetworkSpeed(adb, networkSpeed) {
  if (_lodash.default.values(adb.NETWORK_SPEED).includes(networkSpeed)) {
    return networkSpeed;
  }

  _logger.default.warn(`Wrong network speed param '${networkSpeed}', using default: ${adb.NETWORK_SPEED.FULL}. ` + `Supported values: ${_lodash.default.values(adb.NETWORK_SPEED)}`);

  return adb.NETWORK_SPEED.FULL;
}

function prepareAvdArgs(adb, opts) {
  const {
    networkSpeed,
    isHeadless,
    avdArgs
  } = opts;
  const result = [];

  if (avdArgs) {
    if (_lodash.default.isArray(avdArgs)) {
      result.push(...avdArgs);
    } else {
      result.push(..._support.util.shellParse(`${avdArgs}`));
    }
  }

  if (networkSpeed) {
    result.push('-netspeed', ensureNetworkSpeed(adb, networkSpeed));
  }

  if (isHeadless) {
    result.push('-no-window');
  }

  return result;
}

function toCredentialType(unlockType) {
  const result = {
    [_unlockHelpers.PIN_UNLOCK]: 'pin',
    [_unlockHelpers.PIN_UNLOCK_KEY_EVENT]: 'pin',
    [_unlockHelpers.PASSWORD_UNLOCK]: 'password',
    [_unlockHelpers.PATTERN_UNLOCK]: 'pattern'
  }[unlockType];

  if (result) {
    return result;
  }

  throw new Error(`Unlock type '${unlockType}' is not known`);
}

const helpers = {};
exports.helpers = helpers;

helpers.createBaseADB = async function createBaseADB(opts = {}) {
  const {
    adbPort,
    suppressKillServer,
    remoteAdbHost,
    clearDeviceLogsOnStart,
    adbExecTimeout,
    useKeystore,
    keystorePath,
    keystorePassword,
    keyAlias,
    keyPassword,
    remoteAppsCacheLimit,
    buildToolsVersion,
    allowOfflineDevices,
    allowDelayAdb
  } = opts;
  return await _appiumAdb.default.createADB({
    adbPort,
    suppressKillServer,
    remoteAdbHost,
    clearDeviceLogsOnStart,
    adbExecTimeout,
    useKeystore,
    keystorePath,
    keystorePassword,
    keyAlias,
    keyPassword,
    remoteAppsCacheLimit,
    buildToolsVersion,
    allowOfflineDevices,
    allowDelayAdb
  });
};

helpers.prepareEmulator = async function prepareEmulator(adb, opts) {
  const {
    avd,
    avdEnv: env,
    language,
    locale: country,
    avdLaunchTimeout: launchTimeout,
    avdReadyTimeout: readyTimeout
  } = opts;

  if (!avd) {
    throw new Error('Cannot launch AVD without AVD name');
  }

  const avdName = avd.replace('@', '');
  const runningAVD = await adb.getRunningAVDWithRetry(avdName);
  const args = prepareAvdArgs(adb, opts);

  if (runningAVD) {
    if (args.includes('-wipe-data')) {
      _logger.default.debug(`Killing '${avdName}' because it needs to be wiped at start.`);

      await adb.killEmulator(avdName);
    } else {
      _logger.default.debug('Not launching AVD because it is already running.');

      return;
    }
  }

  await adb.launchAVD(avd, {
    args,
    env,
    language,
    country,
    launchTimeout,
    readyTimeout
  });
};

helpers.ensureDeviceLocale = async function ensureDeviceLocale(adb, language, country, script = null) {
  if (!_lodash.default.isString(language) && !_lodash.default.isString(country)) {
    _logger.default.warn(`setDeviceLanguageCountry requires language or country.`);

    _logger.default.warn(`Got language: '${language}' and country: '${country}'`);

    return;
  }

  await adb.setDeviceLanguageCountry(language, country, script);

  if (!(await adb.ensureCurrentLocale(language, country, script))) {
    const message = script ? `language: ${language}, country: ${country} and script: ${script}` : `language: ${language} and country: ${country}`;
    throw new Error(`Failed to set ${message}`);
  }
};

helpers.getDeviceInfoFromCaps = async function getDeviceInfoFromCaps(opts = {}) {
  const adb = await helpers.createBaseADB(opts);
  let udid = opts.udid;
  let emPort = null;

  if (opts.avd) {
    await helpers.prepareEmulator(adb, opts);
    udid = adb.curDeviceId;
    emPort = adb.emulatorPort;
  } else {
    _logger.default.info('Retrieving device list');

    let devices = await adb.getDevicesWithRetry();

    if (udid) {
      if (!_lodash.default.includes(_lodash.default.map(devices, 'udid'), udid)) {
        _logger.default.errorAndThrow(`Device ${udid} was not in the list of connected devices`);
      }

      emPort = adb.getPortFromEmulatorString(udid);
    } else if (opts.platformVersion) {
      opts.platformVersion = `${opts.platformVersion}`.trim();
      const platformVersion = _semver.default.coerce(opts.platformVersion) || opts.platformVersion;

      _logger.default.info(`Looking for a device with Android '${platformVersion}'`);

      const availDevices = [];
      let partialMatchCandidate = null;

      for (const device of devices) {
        await adb.setDeviceId(device.udid);
        const rawDeviceOS = await adb.getPlatformVersion();
        availDevices.push(`${device.udid} (${rawDeviceOS})`);
        const deviceOS = _semver.default.coerce(rawDeviceOS) || rawDeviceOS;

        if (!deviceOS) {
          continue;
        }

        const bothVersionsCanBeCoerced = _semver.default.valid(deviceOS) && _semver.default.valid(platformVersion);

        const bothVersionsAreStrings = _lodash.default.isString(deviceOS) && _lodash.default.isString(platformVersion);

        if (bothVersionsCanBeCoerced && deviceOS.version === platformVersion.version || bothVersionsAreStrings && _lodash.default.toLower(deviceOS) === _lodash.default.toLower(platformVersion)) {
          udid = device.udid;
          break;
        } else if (!bothVersionsCanBeCoerced) {
          continue;
        }

        if ((!_lodash.default.includes(opts.platformVersion, '.') && platformVersion.major === deviceOS.major || platformVersion.major === deviceOS.major && platformVersion.minor === deviceOS.minor) && (partialMatchCandidate && _semver.default.gt(deviceOS, _lodash.default.values(partialMatchCandidate)[0]) || !partialMatchCandidate)) {
          partialMatchCandidate = {
            [device.udid]: deviceOS
          };
        }
      }

      if (!udid && partialMatchCandidate) {
        udid = _lodash.default.keys(partialMatchCandidate)[0];
        await adb.setDeviceId(udid);
      }

      if (!udid) {
        _logger.default.errorAndThrow(`Unable to find an active device or emulator ` + `with OS ${opts.platformVersion}. The following are available: ` + availDevices.join(', '));
      }

      emPort = adb.getPortFromEmulatorString(udid);
    } else {
      udid = devices[0].udid;
      emPort = adb.getPortFromEmulatorString(udid);
    }
  }

  _logger.default.info(`Using device: ${udid}`);

  return {
    udid,
    emPort
  };
};

helpers.createADB = async function createADB(opts = {}) {
  const {
    udid,
    emPort
  } = opts;
  const adb = await helpers.createBaseADB(opts);
  adb.setDeviceId(udid);

  if (emPort) {
    adb.setEmulatorPort(emPort);
  }

  return adb;
};

helpers.validatePackageActivityNames = function validatePackageActivityNames(opts) {
  for (const key of ['appPackage', 'appActivity', 'appWaitPackage', 'appWaitActivity']) {
    const name = opts[key];

    if (!name) {
      continue;
    }

    const match = /([^\w.*,])+/.exec(name);

    if (!match) {
      continue;
    }

    _logger.default.warn(`Capability '${key}' is expected to only include latin letters, digits, underscore, dot, comma and asterisk characters.`);

    _logger.default.warn(`Current value '${name}' has non-matching character at index ${match.index}: '${name.substring(0, match.index + 1)}'`);
  }
};

helpers.getLaunchInfo = async function getLaunchInfo(adb, opts) {
  let {
    app,
    appPackage,
    appActivity,
    appWaitPackage,
    appWaitActivity
  } = opts;

  if (!app) {
    _logger.default.warn('No app sent in, not parsing package/activity');

    return;
  }

  this.validatePackageActivityNames(opts);

  if (appPackage && appActivity) {
    return;
  }

  _logger.default.debug('Parsing package and activity from app manifest');

  let {
    apkPackage,
    apkActivity
  } = await adb.packageAndLaunchActivityFromManifest(app);

  if (apkPackage && !appPackage) {
    appPackage = apkPackage;
  }

  if (!appWaitPackage) {
    appWaitPackage = appPackage;
  }

  if (apkActivity && !appActivity) {
    appActivity = apkActivity;
  }

  if (!appWaitActivity) {
    appWaitActivity = appActivity;
  }

  _logger.default.debug(`Parsed package and activity are: ${apkPackage}/${apkActivity}`);

  return {
    appPackage,
    appWaitPackage,
    appActivity,
    appWaitActivity
  };
};

helpers.resetApp = async function resetApp(adb, opts = {}) {
  const {
    app,
    appPackage,
    fastReset,
    fullReset,
    androidInstallTimeout = PACKAGE_INSTALL_TIMEOUT,
    autoGrantPermissions,
    allowTestPackages
  } = opts;

  if (!appPackage) {
    throw new Error("'appPackage' option is required");
  }

  const isInstalled = await adb.isAppInstalled(appPackage);

  if (isInstalled) {
    try {
      await adb.forceStop(appPackage);
    } catch (ign) {}

    if (!fullReset && fastReset) {
      const output = await adb.clear(appPackage);

      if (_lodash.default.isString(output) && output.toLowerCase().includes('failed')) {
        throw new Error(`Cannot clear the application data of '${appPackage}'. Original error: ${output}`);
      }

      if (autoGrantPermissions) {
        try {
          await adb.grantAllPermissions(appPackage);
        } catch (error) {
          _logger.default.error(`Unable to grant permissions requested. Original error: ${error.message}`);
        }
      }

      _logger.default.debug(`Performed fast reset on the installed '${appPackage}' application (stop and clear)`);

      return;
    }
  }

  if (!app) {
    throw new Error("'app' option is required for reinstall");
  }

  _logger.default.debug(`Running full reset on '${appPackage}' (reinstall)`);

  if (isInstalled) {
    await adb.uninstallApk(appPackage);
  }

  await adb.install(app, {
    grantPermissions: autoGrantPermissions,
    timeout: androidInstallTimeout,
    allowTestPackages
  });
};

helpers.installApk = async function installApk(adb, opts = {}) {
  const {
    app,
    appPackage,
    fastReset,
    fullReset,
    androidInstallTimeout = PACKAGE_INSTALL_TIMEOUT,
    autoGrantPermissions,
    allowTestPackages,
    enforceAppInstall
  } = opts;

  if (!app || !appPackage) {
    throw new Error("'app' and 'appPackage' options are required");
  }

  if (fullReset) {
    await this.resetApp(adb, opts);
    return;
  }

  const {
    appState,
    wasUninstalled
  } = await adb.installOrUpgrade(app, appPackage, {
    grantPermissions: autoGrantPermissions,
    timeout: androidInstallTimeout,
    allowTestPackages,
    enforceCurrentBuild: enforceAppInstall
  });
  const isInstalledOverExistingApp = !wasUninstalled && appState !== adb.APP_INSTALL_STATE.NOT_INSTALLED;

  if (fastReset && isInstalledOverExistingApp) {
    _logger.default.info(`Performing fast reset on '${appPackage}'`);

    await this.resetApp(adb, opts);
  }
};

helpers.installOtherApks = async function installOtherApks(otherApps, adb, opts) {
  let {
    androidInstallTimeout = PACKAGE_INSTALL_TIMEOUT,
    autoGrantPermissions,
    allowTestPackages
  } = opts;
  await _bluebird.default.all(otherApps.map(otherApp => {
    _logger.default.debug(`Installing app: ${otherApp}`);

    return adb.installOrUpgrade(otherApp, null, {
      grantPermissions: autoGrantPermissions,
      timeout: androidInstallTimeout,
      allowTestPackages
    });
  }));
};

helpers.uninstallOtherPackages = async function uninstallOtherPackages(adb, appPackages, filterPackages = []) {
  if (appPackages.includes('*')) {
    _logger.default.debug('Uninstall third party packages');

    appPackages = await this.getThirdPartyPackages(adb, filterPackages);
  }

  _logger.default.debug(`Uninstalling packages: ${appPackages}`);

  await _bluebird.default.all(appPackages.map(appPackage => adb.uninstallApk(appPackage)));
};

helpers.getThirdPartyPackages = async function getThirdPartyPackages(adb, filterPackages = []) {
  try {
    const packagesString = await adb.shell(['pm', 'list', 'packages', '-3']);
    const appPackagesArray = packagesString.trim().replace(/package:/g, '').split(_os.EOL);

    _logger.default.debug(`'${appPackagesArray}' filtered with '${filterPackages}'`);

    return _lodash.default.difference(appPackagesArray, filterPackages);
  } catch (err) {
    _logger.default.warn(`Unable to get packages with 'adb shell pm list packages -3': ${err.message}`);

    return [];
  }
};

helpers.initUnicodeKeyboard = async function initUnicodeKeyboard(adb) {
  _logger.default.debug('Enabling Unicode keyboard support');

  let defaultIME = await adb.defaultIME();

  _logger.default.debug(`Unsetting previous IME ${defaultIME}`);

  const appiumIME = `${SETTINGS_HELPER_PKG_ID}/.UnicodeIME`;

  _logger.default.debug(`Setting IME to '${appiumIME}'`);

  await adb.enableIME(appiumIME);
  await adb.setIME(appiumIME);
  return defaultIME;
};

helpers.setMockLocationApp = async function setMockLocationApp(adb, app) {
  try {
    if ((await adb.getApiLevel()) < 23) {
      await adb.shell(['settings', 'put', 'secure', 'mock_location', '1']);
    } else {
      await adb.shell(['appops', 'set', app, 'android:mock_location', 'allow']);
    }
  } catch (err) {
    _logger.default.warn(`Unable to set mock location for app '${app}': ${err.message}`);

    return;
  }

  try {
    let pkgIds = [];

    if (await adb.fileExists(MOCK_APP_IDS_STORE)) {
      try {
        pkgIds = JSON.parse(await adb.shell(['cat', MOCK_APP_IDS_STORE]));
      } catch (ign) {}
    }

    if (pkgIds.includes(app)) {
      return;
    }

    pkgIds.push(app);
    const tmpRoot = await _support.tempDir.openDir();

    const srcPath = _path.default.posix.join(tmpRoot, _path.default.posix.basename(MOCK_APP_IDS_STORE));

    try {
      await _support.fs.writeFile(srcPath, JSON.stringify(pkgIds), 'utf8');
      await adb.pushFile(srcPath, MOCK_APP_IDS_STORE);
    } finally {
      await _support.fs.rimraf(tmpRoot);
    }
  } catch (e) {
    _logger.default.warn(`Unable to persist mock location app id '${app}': ${e.message}`);
  }
};

helpers.resetMockLocation = async function resetMockLocation(adb) {
  try {
    if ((await adb.getApiLevel()) < 23) {
      await adb.shell(['settings', 'put', 'secure', 'mock_location', '0']);
      return;
    }

    const thirdPartyPkgIdsPromise = helpers.getThirdPartyPackages(adb);
    let pkgIds = [];

    if (await adb.fileExists(MOCK_APP_IDS_STORE)) {
      try {
        pkgIds = JSON.parse(await adb.shell(['cat', MOCK_APP_IDS_STORE]));
      } catch (ign) {}
    }

    const thirdPartyPkgIds = await thirdPartyPkgIdsPromise;

    const resultPkgs = _lodash.default.intersection(pkgIds, thirdPartyPkgIds);

    if (_lodash.default.size(resultPkgs) <= 1) {
      await adb.shell(['appops', 'set', resultPkgs[0] ?? SETTINGS_HELPER_PKG_ID, 'android:mock_location', 'deny']);
      return;
    }

    _logger.default.debug(`Resetting mock_location permission for the following apps: ${resultPkgs}`);

    await _bluebird.default.all(resultPkgs.map(pkgId => (async () => {
      try {
        await adb.shell(['appops', 'set', pkgId, 'android:mock_location', 'deny']);
      } catch (ign) {}
    })()));
  } catch (err) {
    _logger.default.warn(`Unable to reset mock location: ${err.message}`);
  }
};

helpers.installHelperApp = async function installHelperApp(adb, apkPath, packageId) {
  await (0, _asyncbox.retry)(2, async function retryInstallHelperApp() {
    await adb.installOrUpgrade(apkPath, packageId, {
      grantPermissions: true
    });
  });
};

helpers.pushSettingsApp = async function pushSettingsApp(adb, throwError = false, opts = {}) {
  _logger.default.debug('Pushing settings apk to device...');

  try {
    await helpers.installHelperApp(adb, _ioAppium.path, SETTINGS_HELPER_PKG_ID, throwError);
  } catch (err) {
    if (throwError) {
      throw err;
    }

    _logger.default.warn(`Ignored error while installing '${_ioAppium.path}': ` + `'${err.message}'. Features that rely on this helper ` + 'require the apk such as toggle WiFi and getting location ' + 'will raise an error if you try to use them.');
  }

  if (await adb.processExists(SETTINGS_HELPER_PKG_ID)) {
    _logger.default.debug(`${SETTINGS_HELPER_PKG_ID} is already running. ` + `There is no need to reset its permissions.`);

    return;
  }

  const apiLevel = await adb.getApiLevel();

  if (apiLevel >= 29) {
    try {
      await adb.shell(['appops', 'set', SETTINGS_HELPER_PKG_ID, 'PROJECT_MEDIA', 'allow']);
    } catch (err) {
      _logger.default.debug(err);
    }
  }

  if (apiLevel <= 23) {
    const perms = ['SET_ANIMATION_SCALE', 'CHANGE_CONFIGURATION', 'ACCESS_FINE_LOCATION'];

    _logger.default.info(`Granting permissions ${perms} to '${SETTINGS_HELPER_PKG_ID}'`);

    await adb.grantPermissions(SETTINGS_HELPER_PKG_ID, perms.map(x => `android.permission.${x}`));
  }

  try {
    await adb.requireRunningSettingsApp({
      timeout: helpers.isEmulator(adb, opts) ? 30000 : 5000
    });
  } catch (err) {
    _logger.default.debug(err);

    if (throwError) {
      throw err;
    }
  }
};

helpers.pushStrings = async function pushStrings(language, adb, opts) {
  const remoteDir = '/data/local/tmp';
  const stringsJson = 'strings.json';

  const remoteFile = _path.default.posix.resolve(remoteDir, stringsJson);

  await adb.rimraf(remoteFile);
  let app;

  try {
    app = opts.app || (await adb.pullApk(opts.appPackage, opts.tmpDir));
  } catch (err) {
    _logger.default.info(`Failed to pull an apk from '${opts.appPackage}' to '${opts.tmpDir}'. Original error: ${err.message}`);
  }

  if (_lodash.default.isEmpty(opts.appPackage) || !(await _support.fs.exists(app))) {
    _logger.default.debug(`No app or package specified. Returning empty strings`);

    return {};
  }

  const stringsTmpDir = _path.default.resolve(opts.tmpDir, opts.appPackage);

  try {
    _logger.default.debug('Extracting strings from apk', app, language, stringsTmpDir);

    const {
      apkStrings,
      localPath
    } = await adb.extractStringsFromApk(app, language, stringsTmpDir);
    await adb.push(localPath, remoteDir);
    return apkStrings;
  } catch (err) {
    _logger.default.warn(`Could not get strings, continuing anyway. Original error: ${err.message}`);

    await adb.shell('echo', [`'{}' > ${remoteFile}`]);
  } finally {
    await _support.fs.rimraf(stringsTmpDir);
  }

  return {};
};

helpers.unlockWithHelperApp = async function unlockWithHelperApp(adb) {
  _logger.default.info('Unlocking screen');

  let firstRun = true;
  await (0, _asyncbox.retry)(3, async function launchHelper() {
    if (firstRun) {
      firstRun = false;
    } else {
      try {
        if (!(await adb.isScreenLocked())) {
          return;
        }
      } catch (e) {
        _logger.default.warn(`Error in isScreenLocked: ${e.message}`);

        _logger.default.warn('"adb shell dumpsys window" command has timed out.');

        _logger.default.warn('The reason of this timeout is the delayed adb response. Resetting adb server can improve it.');
      }
    }

    _logger.default.info(`Launching ${SETTINGS_HELPER_UNLOCK_ACTIVITY}`);

    await adb.shell(['am', 'start', '-n', `${SETTINGS_HELPER_PKG_ID}/${SETTINGS_HELPER_UNLOCK_ACTIVITY}`, '-c', 'android.intent.category.LAUNCHER', '-a', 'android.intent.action.MAIN', '-f', '0x10200000']);
    await _bluebird.default.delay(1000);
  });
};

helpers.unlock = async function unlock(driver, adb, capabilities) {
  if (!(await adb.isScreenLocked())) {
    _logger.default.info('Screen already unlocked, doing nothing');

    return;
  }

  _logger.default.debug('Screen is locked, trying to unlock');

  if (!capabilities.unlockType && !capabilities.unlockKey) {
    _logger.default.warn('Using app unlock, this is going to be deprecated!');

    await helpers.unlockWithHelperApp(adb);
    return;
  }

  const {
    unlockType,
    unlockKey,
    unlockStrategy,
    unlockSuccessTimeout
  } = _unlockHelpers.default.validateUnlockCapabilities(capabilities);

  if (unlockKey && unlockType !== _unlockHelpers.FINGERPRINT_UNLOCK && (_lodash.default.isNil(unlockStrategy) || _lodash.default.toLower(unlockStrategy) === 'locksettings') && (await adb.isLockManagementSupported())) {
    await _unlockHelpers.default.fastUnlock(adb, {
      credential: unlockKey,
      credentialType: toCredentialType(unlockType)
    });
  } else {
    const unlockMethod = {
      [_unlockHelpers.PIN_UNLOCK]: _unlockHelpers.default.pinUnlock,
      [_unlockHelpers.PIN_UNLOCK_KEY_EVENT]: _unlockHelpers.default.pinUnlockWithKeyEvent,
      [_unlockHelpers.PASSWORD_UNLOCK]: _unlockHelpers.default.passwordUnlock,
      [_unlockHelpers.PATTERN_UNLOCK]: _unlockHelpers.default.patternUnlock,
      [_unlockHelpers.FINGERPRINT_UNLOCK]: _unlockHelpers.default.fingerprintUnlock
    }[unlockType];
    await unlockMethod(adb, driver, capabilities);
  }

  await helpers.verifyUnlock(adb, unlockSuccessTimeout);
};

helpers.verifyUnlock = async function verifyUnlock(adb, timeoutMs = null) {
  try {
    await (0, _asyncbox.waitForCondition)(async () => !(await adb.isScreenLocked()), {
      waitMs: timeoutMs ?? 2000,
      intervalMs: 500
    });
  } catch (ign) {
    throw new Error('The device has failed to be unlocked');
  }

  _logger.default.info('The device has been successfully unlocked');
};

helpers.initDevice = async function initDevice(adb, opts) {
  const {
    skipDeviceInitialization,
    locale,
    language,
    localeScript,
    unicodeKeyboard,
    disableWindowAnimation,
    skipUnlock,
    mockLocationApp,
    skipLogcatCapture,
    logcatFormat,
    logcatFilterSpecs
  } = opts;

  if (skipDeviceInitialization) {
    _logger.default.info(`'skipDeviceInitialization' is set. Skipping device initialization.`);
  } else {
    await adb.waitForDevice();
    const shouldThrowError = language || locale || localeScript || unicodeKeyboard || disableWindowAnimation || !skipUnlock;
    await helpers.pushSettingsApp(adb, shouldThrowError, opts);
  }

  if (!helpers.isEmulator(adb, opts)) {
    if (mockLocationApp || _lodash.default.isUndefined(mockLocationApp)) {
      await helpers.setMockLocationApp(adb, mockLocationApp || SETTINGS_HELPER_PKG_ID);
    } else {
      await helpers.resetMockLocation(adb);
    }
  }

  if (language || locale) {
    await helpers.ensureDeviceLocale(adb, language, locale, localeScript);
  }

  if (skipLogcatCapture) {
    _logger.default.info(`'skipLogcatCapture' is set. Skipping starting logcat capture.`);
  } else {
    await adb.startLogcat({
      format: logcatFormat,
      filterSpecs: logcatFilterSpecs
    });
  }

  if (unicodeKeyboard) {
    return await helpers.initUnicodeKeyboard(adb);
  }
};

helpers.removeNullProperties = function removeNullProperties(obj) {
  for (let key of _lodash.default.keys(obj)) {
    if (_lodash.default.isNull(obj[key]) || _lodash.default.isUndefined(obj[key])) {
      delete obj[key];
    }
  }
};

helpers.truncateDecimals = function truncateDecimals(number, digits) {
  let multiplier = Math.pow(10, digits),
      adjustedNum = number * multiplier,
      truncatedNum = Math[adjustedNum < 0 ? 'ceil' : 'floor'](adjustedNum);
  return truncatedNum / multiplier;
};

helpers.isChromeBrowser = function isChromeBrowser(browser) {
  return _lodash.default.includes(Object.keys(CHROME_BROWSER_PACKAGE_ACTIVITY), (browser || '').toLowerCase());
};

helpers.getChromePkg = function getChromePkg(browser) {
  return CHROME_BROWSER_PACKAGE_ACTIVITY[browser.toLowerCase()] || CHROME_BROWSER_PACKAGE_ACTIVITY.default;
};

helpers.removeAllSessionWebSocketHandlers = async function removeAllSessionWebSocketHandlers(server, sessionId) {
  if (!server || !_lodash.default.isFunction(server.getWebSocketHandlers)) {
    return;
  }

  const activeHandlers = await server.getWebSocketHandlers(sessionId);

  for (const pathname of _lodash.default.keys(activeHandlers)) {
    await server.removeWebSocketHandler(pathname);
  }
};

helpers.parseArray = function parseArray(cap) {
  let parsedCaps;

  try {
    parsedCaps = JSON.parse(cap);
  } catch (ign) {}

  if (_lodash.default.isArray(parsedCaps)) {
    return parsedCaps;
  } else if (_lodash.default.isString(cap)) {
    return [cap];
  }

  throw new Error(`must provide a string or JSON Array; received ${cap}`);
};

helpers.validateDesiredCaps = function validateDesiredCaps(caps) {
  if (caps.browserName) {
    if (caps.app) {
      _logger.default.warn(`The desired capabilities should generally not include both an 'app' and a 'browserName'`);
    }

    if (caps.appPackage) {
      _logger.default.errorAndThrow(`The desired should not include both of an 'appPackage' and a 'browserName'`);
    }
  }

  if (caps.uninstallOtherPackages) {
    try {
      this.parseArray(caps.uninstallOtherPackages);
    } catch (e) {
      _logger.default.errorAndThrow(`Could not parse "uninstallOtherPackages" capability: ${e.message}`);
    }
  }

  return true;
};

helpers.adjustBrowserSessionCaps = function adjustBrowserSessionCaps(caps = {}) {
  const {
    browserName
  } = caps;

  _logger.default.info(`The current session is considered browser-based`);

  _logger.default.info(`Supported browser names: ${JSON.stringify(_lodash.default.keys(CHROME_BROWSER_PACKAGE_ACTIVITY))}`);

  if (caps.appPackage || caps.appActivity) {
    _logger.default.info(`Not overriding appPackage/appActivity capability values for '${browserName}' ` + 'because some of them have been already provided');

    return caps;
  }

  const {
    pkg,
    activity
  } = this.getChromePkg(browserName);
  caps.appPackage = pkg;
  caps.appActivity = activity;

  _logger.default.info(`appPackage/appActivity capabilities have been automatically set to ${pkg}/${activity} ` + `for '${browserName}'`);

  _logger.default.info(`Consider changing the browserName to the one from the list of supported browser names ` + `or provide custom appPackage/appActivity capability values if the automatically assigned ones do ` + `not make sense`);

  return caps;
};

helpers.isEmulator = function isEmulator(adb, opts) {
  const possibleNames = [opts.udid, adb === null || adb === void 0 ? void 0 : adb.curDeviceId];
  return !!opts.avd || possibleNames.some(x => EMULATOR_PATTERN.test(x));
};

helpers.bootstrap = _bootstrap.default;
helpers.unlocker = _unlockHelpers.default;
var _default = helpers;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNT0NLX0FQUF9JRFNfU1RPUkUiLCJQQUNLQUdFX0lOU1RBTExfVElNRU9VVCIsIkNIUk9NRV9CUk9XU0VSX1BBQ0tBR0VfQUNUSVZJVFkiLCJjaHJvbWUiLCJwa2ciLCJhY3Rpdml0eSIsImNocm9taXVtIiwiY2hyb21lYmV0YSIsImJyb3dzZXIiLCJkZWZhdWx0IiwiU0VUVElOR1NfSEVMUEVSX1BLR19JRCIsIlNFVFRJTkdTX0hFTFBFUl9VTkxPQ0tfQUNUSVZJVFkiLCJFTVVMQVRPUl9QQVRURVJOIiwiQVBQX1NUQVRFIiwiT2JqZWN0IiwiZnJlZXplIiwiTk9UX0lOU1RBTExFRCIsIk5PVF9SVU5OSU5HIiwiUlVOTklOR19JTl9CQUNLR1JPVU5EIiwiUlVOTklOR19JTl9GT1JFR1JPVU5EIiwiZW5zdXJlTmV0d29ya1NwZWVkIiwiYWRiIiwibmV0d29ya1NwZWVkIiwiXyIsInZhbHVlcyIsIk5FVFdPUktfU1BFRUQiLCJpbmNsdWRlcyIsImxvZ2dlciIsIndhcm4iLCJGVUxMIiwicHJlcGFyZUF2ZEFyZ3MiLCJvcHRzIiwiaXNIZWFkbGVzcyIsImF2ZEFyZ3MiLCJyZXN1bHQiLCJpc0FycmF5IiwicHVzaCIsInV0aWwiLCJzaGVsbFBhcnNlIiwidG9DcmVkZW50aWFsVHlwZSIsInVubG9ja1R5cGUiLCJQSU5fVU5MT0NLIiwiUElOX1VOTE9DS19LRVlfRVZFTlQiLCJQQVNTV09SRF9VTkxPQ0siLCJQQVRURVJOX1VOTE9DSyIsIkVycm9yIiwiaGVscGVycyIsImNyZWF0ZUJhc2VBREIiLCJhZGJQb3J0Iiwic3VwcHJlc3NLaWxsU2VydmVyIiwicmVtb3RlQWRiSG9zdCIsImNsZWFyRGV2aWNlTG9nc09uU3RhcnQiLCJhZGJFeGVjVGltZW91dCIsInVzZUtleXN0b3JlIiwia2V5c3RvcmVQYXRoIiwia2V5c3RvcmVQYXNzd29yZCIsImtleUFsaWFzIiwia2V5UGFzc3dvcmQiLCJyZW1vdGVBcHBzQ2FjaGVMaW1pdCIsImJ1aWxkVG9vbHNWZXJzaW9uIiwiYWxsb3dPZmZsaW5lRGV2aWNlcyIsImFsbG93RGVsYXlBZGIiLCJBREIiLCJjcmVhdGVBREIiLCJwcmVwYXJlRW11bGF0b3IiLCJhdmQiLCJhdmRFbnYiLCJlbnYiLCJsYW5ndWFnZSIsImxvY2FsZSIsImNvdW50cnkiLCJhdmRMYXVuY2hUaW1lb3V0IiwibGF1bmNoVGltZW91dCIsImF2ZFJlYWR5VGltZW91dCIsInJlYWR5VGltZW91dCIsImF2ZE5hbWUiLCJyZXBsYWNlIiwicnVubmluZ0FWRCIsImdldFJ1bm5pbmdBVkRXaXRoUmV0cnkiLCJhcmdzIiwiZGVidWciLCJraWxsRW11bGF0b3IiLCJsYXVuY2hBVkQiLCJlbnN1cmVEZXZpY2VMb2NhbGUiLCJzY3JpcHQiLCJpc1N0cmluZyIsInNldERldmljZUxhbmd1YWdlQ291bnRyeSIsImVuc3VyZUN1cnJlbnRMb2NhbGUiLCJtZXNzYWdlIiwiZ2V0RGV2aWNlSW5mb0Zyb21DYXBzIiwidWRpZCIsImVtUG9ydCIsImN1ckRldmljZUlkIiwiZW11bGF0b3JQb3J0IiwiaW5mbyIsImRldmljZXMiLCJnZXREZXZpY2VzV2l0aFJldHJ5IiwibWFwIiwiZXJyb3JBbmRUaHJvdyIsImdldFBvcnRGcm9tRW11bGF0b3JTdHJpbmciLCJwbGF0Zm9ybVZlcnNpb24iLCJ0cmltIiwic2VtdmVyIiwiY29lcmNlIiwiYXZhaWxEZXZpY2VzIiwicGFydGlhbE1hdGNoQ2FuZGlkYXRlIiwiZGV2aWNlIiwic2V0RGV2aWNlSWQiLCJyYXdEZXZpY2VPUyIsImdldFBsYXRmb3JtVmVyc2lvbiIsImRldmljZU9TIiwiYm90aFZlcnNpb25zQ2FuQmVDb2VyY2VkIiwidmFsaWQiLCJib3RoVmVyc2lvbnNBcmVTdHJpbmdzIiwidmVyc2lvbiIsInRvTG93ZXIiLCJtYWpvciIsIm1pbm9yIiwiZ3QiLCJrZXlzIiwiam9pbiIsInNldEVtdWxhdG9yUG9ydCIsInZhbGlkYXRlUGFja2FnZUFjdGl2aXR5TmFtZXMiLCJrZXkiLCJuYW1lIiwibWF0Y2giLCJleGVjIiwiaW5kZXgiLCJzdWJzdHJpbmciLCJnZXRMYXVuY2hJbmZvIiwiYXBwIiwiYXBwUGFja2FnZSIsImFwcEFjdGl2aXR5IiwiYXBwV2FpdFBhY2thZ2UiLCJhcHBXYWl0QWN0aXZpdHkiLCJhcGtQYWNrYWdlIiwiYXBrQWN0aXZpdHkiLCJwYWNrYWdlQW5kTGF1bmNoQWN0aXZpdHlGcm9tTWFuaWZlc3QiLCJyZXNldEFwcCIsImZhc3RSZXNldCIsImZ1bGxSZXNldCIsImFuZHJvaWRJbnN0YWxsVGltZW91dCIsImF1dG9HcmFudFBlcm1pc3Npb25zIiwiYWxsb3dUZXN0UGFja2FnZXMiLCJpc0luc3RhbGxlZCIsImlzQXBwSW5zdGFsbGVkIiwiZm9yY2VTdG9wIiwiaWduIiwib3V0cHV0IiwiY2xlYXIiLCJ0b0xvd2VyQ2FzZSIsImdyYW50QWxsUGVybWlzc2lvbnMiLCJlcnJvciIsInVuaW5zdGFsbEFwayIsImluc3RhbGwiLCJncmFudFBlcm1pc3Npb25zIiwidGltZW91dCIsImluc3RhbGxBcGsiLCJlbmZvcmNlQXBwSW5zdGFsbCIsImFwcFN0YXRlIiwid2FzVW5pbnN0YWxsZWQiLCJpbnN0YWxsT3JVcGdyYWRlIiwiZW5mb3JjZUN1cnJlbnRCdWlsZCIsImlzSW5zdGFsbGVkT3ZlckV4aXN0aW5nQXBwIiwiQVBQX0lOU1RBTExfU1RBVEUiLCJpbnN0YWxsT3RoZXJBcGtzIiwib3RoZXJBcHBzIiwiQiIsImFsbCIsIm90aGVyQXBwIiwidW5pbnN0YWxsT3RoZXJQYWNrYWdlcyIsImFwcFBhY2thZ2VzIiwiZmlsdGVyUGFja2FnZXMiLCJnZXRUaGlyZFBhcnR5UGFja2FnZXMiLCJwYWNrYWdlc1N0cmluZyIsInNoZWxsIiwiYXBwUGFja2FnZXNBcnJheSIsInNwbGl0IiwiRU9MIiwiZGlmZmVyZW5jZSIsImVyciIsImluaXRVbmljb2RlS2V5Ym9hcmQiLCJkZWZhdWx0SU1FIiwiYXBwaXVtSU1FIiwiZW5hYmxlSU1FIiwic2V0SU1FIiwic2V0TW9ja0xvY2F0aW9uQXBwIiwiZ2V0QXBpTGV2ZWwiLCJwa2dJZHMiLCJmaWxlRXhpc3RzIiwiSlNPTiIsInBhcnNlIiwidG1wUm9vdCIsInRlbXBEaXIiLCJvcGVuRGlyIiwic3JjUGF0aCIsInBhdGgiLCJwb3NpeCIsImJhc2VuYW1lIiwiZnMiLCJ3cml0ZUZpbGUiLCJzdHJpbmdpZnkiLCJwdXNoRmlsZSIsInJpbXJhZiIsImUiLCJyZXNldE1vY2tMb2NhdGlvbiIsInRoaXJkUGFydHlQa2dJZHNQcm9taXNlIiwidGhpcmRQYXJ0eVBrZ0lkcyIsInJlc3VsdFBrZ3MiLCJpbnRlcnNlY3Rpb24iLCJzaXplIiwicGtnSWQiLCJpbnN0YWxsSGVscGVyQXBwIiwiYXBrUGF0aCIsInBhY2thZ2VJZCIsInJldHJ5IiwicmV0cnlJbnN0YWxsSGVscGVyQXBwIiwicHVzaFNldHRpbmdzQXBwIiwidGhyb3dFcnJvciIsInNldHRpbmdzQXBrUGF0aCIsInByb2Nlc3NFeGlzdHMiLCJhcGlMZXZlbCIsInBlcm1zIiwieCIsInJlcXVpcmVSdW5uaW5nU2V0dGluZ3NBcHAiLCJpc0VtdWxhdG9yIiwicHVzaFN0cmluZ3MiLCJyZW1vdGVEaXIiLCJzdHJpbmdzSnNvbiIsInJlbW90ZUZpbGUiLCJyZXNvbHZlIiwicHVsbEFwayIsInRtcERpciIsImlzRW1wdHkiLCJleGlzdHMiLCJzdHJpbmdzVG1wRGlyIiwiYXBrU3RyaW5ncyIsImxvY2FsUGF0aCIsImV4dHJhY3RTdHJpbmdzRnJvbUFwayIsInVubG9ja1dpdGhIZWxwZXJBcHAiLCJmaXJzdFJ1biIsImxhdW5jaEhlbHBlciIsImlzU2NyZWVuTG9ja2VkIiwiZGVsYXkiLCJ1bmxvY2siLCJkcml2ZXIiLCJjYXBhYmlsaXRpZXMiLCJ1bmxvY2tLZXkiLCJ1bmxvY2tTdHJhdGVneSIsInVubG9ja1N1Y2Nlc3NUaW1lb3V0IiwidW5sb2NrZXIiLCJ2YWxpZGF0ZVVubG9ja0NhcGFiaWxpdGllcyIsIkZJTkdFUlBSSU5UX1VOTE9DSyIsImlzTmlsIiwiaXNMb2NrTWFuYWdlbWVudFN1cHBvcnRlZCIsImZhc3RVbmxvY2siLCJjcmVkZW50aWFsIiwiY3JlZGVudGlhbFR5cGUiLCJ1bmxvY2tNZXRob2QiLCJwaW5VbmxvY2siLCJwaW5VbmxvY2tXaXRoS2V5RXZlbnQiLCJwYXNzd29yZFVubG9jayIsInBhdHRlcm5VbmxvY2siLCJmaW5nZXJwcmludFVubG9jayIsInZlcmlmeVVubG9jayIsInRpbWVvdXRNcyIsIndhaXRGb3JDb25kaXRpb24iLCJ3YWl0TXMiLCJpbnRlcnZhbE1zIiwiaW5pdERldmljZSIsInNraXBEZXZpY2VJbml0aWFsaXphdGlvbiIsImxvY2FsZVNjcmlwdCIsInVuaWNvZGVLZXlib2FyZCIsImRpc2FibGVXaW5kb3dBbmltYXRpb24iLCJza2lwVW5sb2NrIiwibW9ja0xvY2F0aW9uQXBwIiwic2tpcExvZ2NhdENhcHR1cmUiLCJsb2djYXRGb3JtYXQiLCJsb2djYXRGaWx0ZXJTcGVjcyIsIndhaXRGb3JEZXZpY2UiLCJzaG91bGRUaHJvd0Vycm9yIiwiaXNVbmRlZmluZWQiLCJzdGFydExvZ2NhdCIsImZvcm1hdCIsImZpbHRlclNwZWNzIiwicmVtb3ZlTnVsbFByb3BlcnRpZXMiLCJvYmoiLCJpc051bGwiLCJ0cnVuY2F0ZURlY2ltYWxzIiwibnVtYmVyIiwiZGlnaXRzIiwibXVsdGlwbGllciIsIk1hdGgiLCJwb3ciLCJhZGp1c3RlZE51bSIsInRydW5jYXRlZE51bSIsImlzQ2hyb21lQnJvd3NlciIsImdldENocm9tZVBrZyIsInJlbW92ZUFsbFNlc3Npb25XZWJTb2NrZXRIYW5kbGVycyIsInNlcnZlciIsInNlc3Npb25JZCIsImlzRnVuY3Rpb24iLCJnZXRXZWJTb2NrZXRIYW5kbGVycyIsImFjdGl2ZUhhbmRsZXJzIiwicGF0aG5hbWUiLCJyZW1vdmVXZWJTb2NrZXRIYW5kbGVyIiwicGFyc2VBcnJheSIsImNhcCIsInBhcnNlZENhcHMiLCJ2YWxpZGF0ZURlc2lyZWRDYXBzIiwiY2FwcyIsImJyb3dzZXJOYW1lIiwiYWRqdXN0QnJvd3NlclNlc3Npb25DYXBzIiwicG9zc2libGVOYW1lcyIsInNvbWUiLCJ0ZXN0IiwiYm9vdHN0cmFwIiwiQm9vdHN0cmFwIl0sInNvdXJjZXMiOlsiLi4vLi4vbGliL2FuZHJvaWQtaGVscGVycy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyByZXRyeSwgd2FpdEZvckNvbmRpdGlvbiB9IGZyb20gJ2FzeW5jYm94JztcbmltcG9ydCBsb2dnZXIgZnJvbSAnLi9sb2dnZXInO1xuaW1wb3J0IHsgZnMsIHV0aWwsIHRlbXBEaXIgfSBmcm9tICdhcHBpdW0vc3VwcG9ydCc7XG5pbXBvcnQgeyBwYXRoIGFzIHNldHRpbmdzQXBrUGF0aCB9IGZyb20gJ2lvLmFwcGl1bS5zZXR0aW5ncyc7XG5pbXBvcnQgQm9vdHN0cmFwIGZyb20gJy4vYm9vdHN0cmFwJztcbmltcG9ydCBCIGZyb20gJ2JsdWViaXJkJztcbmltcG9ydCBBREIgZnJvbSAnYXBwaXVtLWFkYic7XG5pbXBvcnQge1xuICBkZWZhdWx0IGFzIHVubG9ja2VyLCBQSU5fVU5MT0NLLCBQSU5fVU5MT0NLX0tFWV9FVkVOVCxcbiAgUEFTU1dPUkRfVU5MT0NLLCBQQVRURVJOX1VOTE9DSywgRklOR0VSUFJJTlRfVU5MT0NLXG59IGZyb20gJy4vdW5sb2NrLWhlbHBlcnMnO1xuaW1wb3J0IHsgRU9MIH0gZnJvbSAnb3MnO1xuaW1wb3J0IHNlbXZlciBmcm9tICdzZW12ZXInO1xuXG5jb25zdCBNT0NLX0FQUF9JRFNfU1RPUkUgPSAnL2RhdGEvbG9jYWwvdG1wL21vY2tfYXBwcy5qc29uJztcbmNvbnN0IFBBQ0tBR0VfSU5TVEFMTF9USU1FT1VUID0gOTAwMDA7IC8vIG1pbGxpc2Vjb25kc1xuLy8gaHR0cHM6Ly9jcy5jaHJvbWl1bS5vcmcvY2hyb21pdW0vc3JjL2Nocm9tZS9icm93c2VyL2RldnRvb2xzL2RldmljZS9hbmRyb2lkX2RldmljZV9pbmZvX3F1ZXJ5LmNjXG5jb25zdCBDSFJPTUVfQlJPV1NFUl9QQUNLQUdFX0FDVElWSVRZID0ge1xuICBjaHJvbWU6IHtcbiAgICBwa2c6ICdjb20uYW5kcm9pZC5jaHJvbWUnLFxuICAgIGFjdGl2aXR5OiAnY29tLmdvb2dsZS5hbmRyb2lkLmFwcHMuY2hyb21lLk1haW4nLFxuICB9LFxuICBjaHJvbWl1bToge1xuICAgIHBrZzogJ29yZy5jaHJvbWl1bS5jaHJvbWUuc2hlbGwnLFxuICAgIGFjdGl2aXR5OiAnLkNocm9tZVNoZWxsQWN0aXZpdHknLFxuICB9LFxuICBjaHJvbWViZXRhOiB7XG4gICAgcGtnOiAnY29tLmNocm9tZS5iZXRhJyxcbiAgICBhY3Rpdml0eTogJ2NvbS5nb29nbGUuYW5kcm9pZC5hcHBzLmNocm9tZS5NYWluJyxcbiAgfSxcbiAgYnJvd3Nlcjoge1xuICAgIHBrZzogJ2NvbS5hbmRyb2lkLmJyb3dzZXInLFxuICAgIGFjdGl2aXR5OiAnY29tLmFuZHJvaWQuYnJvd3Nlci5Ccm93c2VyQWN0aXZpdHknLFxuICB9LFxuICAnY2hyb21pdW0tYnJvd3Nlcic6IHtcbiAgICBwa2c6ICdvcmcuY2hyb21pdW0uY2hyb21lJyxcbiAgICBhY3Rpdml0eTogJ2NvbS5nb29nbGUuYW5kcm9pZC5hcHBzLmNocm9tZS5NYWluJyxcbiAgfSxcbiAgJ2Nocm9taXVtLXdlYnZpZXcnOiB7XG4gICAgcGtnOiAnb3JnLmNocm9taXVtLndlYnZpZXdfc2hlbGwnLFxuICAgIGFjdGl2aXR5OiAnb3JnLmNocm9taXVtLndlYnZpZXdfc2hlbGwuV2ViVmlld0Jyb3dzZXJBY3Rpdml0eScsXG4gIH0sXG4gIGRlZmF1bHQ6IHtcbiAgICBwa2c6ICdjb20uYW5kcm9pZC5jaHJvbWUnLFxuICAgIGFjdGl2aXR5OiAnY29tLmdvb2dsZS5hbmRyb2lkLmFwcHMuY2hyb21lLk1haW4nLFxuICB9LFxufTtcbmNvbnN0IFNFVFRJTkdTX0hFTFBFUl9QS0dfSUQgPSAnaW8uYXBwaXVtLnNldHRpbmdzJztcbmNvbnN0IFNFVFRJTkdTX0hFTFBFUl9VTkxPQ0tfQUNUSVZJVFkgPSAnLlVubG9jayc7XG5jb25zdCBFTVVMQVRPUl9QQVRURVJOID0gL1xcYmVtdWxhdG9yXFxiL2k7XG4vLyBUaGVzZSBjb25zdGFudHMgYXJlIGluIHN5bmMgd2l0aFxuLy8gaHR0cHM6Ly9kZXZlbG9wZXIuYXBwbGUuY29tL2RvY3VtZW50YXRpb24veGN0ZXN0L3hjdWlhcHBsaWNhdGlvbnN0YXRlL3hjdWlhcHBsaWNhdGlvbnN0YXRlcnVubmluZ2JhY2tncm91bmQ/bGFuZ3VhZ2U9b2JqY1xuY29uc3QgQVBQX1NUQVRFID0gT2JqZWN0LmZyZWV6ZSh7XG4gIE5PVF9JTlNUQUxMRUQ6IDAsXG4gIE5PVF9SVU5OSU5HOiAxLFxuICBSVU5OSU5HX0lOX0JBQ0tHUk9VTkQ6IDMsXG4gIFJVTk5JTkdfSU5fRk9SRUdST1VORDogNFxufSk7XG5cblxuZnVuY3Rpb24gZW5zdXJlTmV0d29ya1NwZWVkIChhZGIsIG5ldHdvcmtTcGVlZCkge1xuICBpZiAoXy52YWx1ZXMoYWRiLk5FVFdPUktfU1BFRUQpLmluY2x1ZGVzKG5ldHdvcmtTcGVlZCkpIHtcbiAgICByZXR1cm4gbmV0d29ya1NwZWVkO1xuICB9XG4gIGxvZ2dlci53YXJuKGBXcm9uZyBuZXR3b3JrIHNwZWVkIHBhcmFtICcke25ldHdvcmtTcGVlZH0nLCB1c2luZyBkZWZhdWx0OiAke2FkYi5ORVRXT1JLX1NQRUVELkZVTEx9LiBgICtcbiAgICBgU3VwcG9ydGVkIHZhbHVlczogJHtfLnZhbHVlcyhhZGIuTkVUV09SS19TUEVFRCl9YCk7XG4gIHJldHVybiBhZGIuTkVUV09SS19TUEVFRC5GVUxMO1xufVxuXG5mdW5jdGlvbiBwcmVwYXJlQXZkQXJncyAoYWRiLCBvcHRzKSB7XG4gIGNvbnN0IHtcbiAgICBuZXR3b3JrU3BlZWQsXG4gICAgaXNIZWFkbGVzcyxcbiAgICBhdmRBcmdzLFxuICB9ID0gb3B0cztcbiAgY29uc3QgcmVzdWx0ID0gW107XG4gIGlmIChhdmRBcmdzKSB7XG4gICAgaWYgKF8uaXNBcnJheShhdmRBcmdzKSkge1xuICAgICAgcmVzdWx0LnB1c2goLi4uYXZkQXJncyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc3VsdC5wdXNoKC4uLih1dGlsLnNoZWxsUGFyc2UoYCR7YXZkQXJnc31gKSkpO1xuICAgIH1cbiAgfVxuICBpZiAobmV0d29ya1NwZWVkKSB7XG4gICAgcmVzdWx0LnB1c2goJy1uZXRzcGVlZCcsIGVuc3VyZU5ldHdvcmtTcGVlZChhZGIsIG5ldHdvcmtTcGVlZCkpO1xuICB9XG4gIGlmIChpc0hlYWRsZXNzKSB7XG4gICAgcmVzdWx0LnB1c2goJy1uby13aW5kb3cnKTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5mdW5jdGlvbiB0b0NyZWRlbnRpYWxUeXBlICh1bmxvY2tUeXBlKSB7XG4gIGNvbnN0IHJlc3VsdCA9IHtcbiAgICBbUElOX1VOTE9DS106ICdwaW4nLFxuICAgIFtQSU5fVU5MT0NLX0tFWV9FVkVOVF06ICdwaW4nLFxuICAgIFtQQVNTV09SRF9VTkxPQ0tdOiAncGFzc3dvcmQnLFxuICAgIFtQQVRURVJOX1VOTE9DS106ICdwYXR0ZXJuJyxcbiAgfVt1bmxvY2tUeXBlXTtcbiAgaWYgKHJlc3VsdCkge1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbiAgdGhyb3cgbmV3IEVycm9yKGBVbmxvY2sgdHlwZSAnJHt1bmxvY2tUeXBlfScgaXMgbm90IGtub3duYCk7XG59XG5cblxuY29uc3QgaGVscGVycyA9IHt9O1xuXG5oZWxwZXJzLmNyZWF0ZUJhc2VBREIgPSBhc3luYyBmdW5jdGlvbiBjcmVhdGVCYXNlQURCIChvcHRzID0ge30pIHtcbiAgLy8gZmlsdGVyIG91dCBhbnkgdW53YW50ZWQgb3B0aW9ucyBzZW50IGluXG4gIC8vIHRoaXMgbGlzdCBzaG91bGQgYmUgdXBkYXRlZCBhcyBBREIgdGFrZXMgbW9yZSBhcmd1bWVudHNcbiAgY29uc3Qge1xuICAgIGFkYlBvcnQsXG4gICAgc3VwcHJlc3NLaWxsU2VydmVyLFxuICAgIHJlbW90ZUFkYkhvc3QsXG4gICAgY2xlYXJEZXZpY2VMb2dzT25TdGFydCxcbiAgICBhZGJFeGVjVGltZW91dCxcbiAgICB1c2VLZXlzdG9yZSxcbiAgICBrZXlzdG9yZVBhdGgsXG4gICAga2V5c3RvcmVQYXNzd29yZCxcbiAgICBrZXlBbGlhcyxcbiAgICBrZXlQYXNzd29yZCxcbiAgICByZW1vdGVBcHBzQ2FjaGVMaW1pdCxcbiAgICBidWlsZFRvb2xzVmVyc2lvbixcbiAgICBhbGxvd09mZmxpbmVEZXZpY2VzLFxuICAgIGFsbG93RGVsYXlBZGIsXG4gIH0gPSBvcHRzO1xuICByZXR1cm4gYXdhaXQgQURCLmNyZWF0ZUFEQih7XG4gICAgYWRiUG9ydCxcbiAgICBzdXBwcmVzc0tpbGxTZXJ2ZXIsXG4gICAgcmVtb3RlQWRiSG9zdCxcbiAgICBjbGVhckRldmljZUxvZ3NPblN0YXJ0LFxuICAgIGFkYkV4ZWNUaW1lb3V0LFxuICAgIHVzZUtleXN0b3JlLFxuICAgIGtleXN0b3JlUGF0aCxcbiAgICBrZXlzdG9yZVBhc3N3b3JkLFxuICAgIGtleUFsaWFzLFxuICAgIGtleVBhc3N3b3JkLFxuICAgIHJlbW90ZUFwcHNDYWNoZUxpbWl0LFxuICAgIGJ1aWxkVG9vbHNWZXJzaW9uLFxuICAgIGFsbG93T2ZmbGluZURldmljZXMsXG4gICAgYWxsb3dEZWxheUFkYixcbiAgfSk7XG59O1xuXG5oZWxwZXJzLnByZXBhcmVFbXVsYXRvciA9IGFzeW5jIGZ1bmN0aW9uIHByZXBhcmVFbXVsYXRvciAoYWRiLCBvcHRzKSB7XG4gIGNvbnN0IHtcbiAgICBhdmQsXG4gICAgYXZkRW52OiBlbnYsXG4gICAgbGFuZ3VhZ2UsXG4gICAgbG9jYWxlOiBjb3VudHJ5LFxuICAgIGF2ZExhdW5jaFRpbWVvdXQ6IGxhdW5jaFRpbWVvdXQsXG4gICAgYXZkUmVhZHlUaW1lb3V0OiByZWFkeVRpbWVvdXQsXG4gIH0gPSBvcHRzO1xuICBpZiAoIWF2ZCkge1xuICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGxhdW5jaCBBVkQgd2l0aG91dCBBVkQgbmFtZScpO1xuICB9XG5cbiAgY29uc3QgYXZkTmFtZSA9IGF2ZC5yZXBsYWNlKCdAJywgJycpO1xuICBjb25zdCBydW5uaW5nQVZEID0gYXdhaXQgYWRiLmdldFJ1bm5pbmdBVkRXaXRoUmV0cnkoYXZkTmFtZSk7XG4gIGNvbnN0IGFyZ3MgPSBwcmVwYXJlQXZkQXJncyhhZGIsIG9wdHMpO1xuICBpZiAocnVubmluZ0FWRCkge1xuICAgIGlmIChhcmdzLmluY2x1ZGVzKCctd2lwZS1kYXRhJykpIHtcbiAgICAgIGxvZ2dlci5kZWJ1ZyhgS2lsbGluZyAnJHthdmROYW1lfScgYmVjYXVzZSBpdCBuZWVkcyB0byBiZSB3aXBlZCBhdCBzdGFydC5gKTtcbiAgICAgIGF3YWl0IGFkYi5raWxsRW11bGF0b3IoYXZkTmFtZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvZ2dlci5kZWJ1ZygnTm90IGxhdW5jaGluZyBBVkQgYmVjYXVzZSBpdCBpcyBhbHJlYWR5IHJ1bm5pbmcuJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG4gIGF3YWl0IGFkYi5sYXVuY2hBVkQoYXZkLCB7XG4gICAgYXJncyxcbiAgICBlbnYsXG4gICAgbGFuZ3VhZ2UsXG4gICAgY291bnRyeSxcbiAgICBsYXVuY2hUaW1lb3V0LFxuICAgIHJlYWR5VGltZW91dCxcbiAgfSk7XG59O1xuXG4vKipcbiAqIFNldCBhbmQgZW5zdXJlIHRoZSBsb2NhbGUgbmFtZSBvZiB0aGUgZGV2aWNlIHVuZGVyIHRlc3QuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGFkYiAtIFRoZSBhZGIgbW9kdWxlIGluc3RhbmNlLlxuICogQHBhcmFtIHtzdHJpbmd9IGxhbmd1YWdlIC0gTGFuZ3VhZ2UuIFRoZSBsYW5ndWFnZSBmaWVsZCBpcyBjYXNlIGluc2Vuc2l0aXZlLCBidXQgTG9jYWxlIGFsd2F5cyBjYW5vbmljYWxpemVzIHRvIGxvd2VyIGNhc2UuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFthLXpBLVpdezIsOH0uIGUuZy4gZW4sIGphIDogaHR0cHM6Ly9kZXZlbG9wZXIuYW5kcm9pZC5jb20vcmVmZXJlbmNlL2phdmEvdXRpbC9Mb2NhbGUuaHRtbFxuICogQHBhcmFtIHtzdHJpbmd9IGNvdW50cnkgLSBDb3VudHJ5LiBUaGUgY291bnRyeSAocmVnaW9uKSBmaWVsZCBpcyBjYXNlIGluc2Vuc2l0aXZlLCBidXQgTG9jYWxlIGFsd2F5cyBjYW5vbmljYWxpemVzIHRvIHVwcGVyIGNhc2UuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFthLXpBLVpdezJ9IHwgWzAtOV17M30uIGUuZy4gVVMsIEpQIDogaHR0cHM6Ly9kZXZlbG9wZXIuYW5kcm9pZC5jb20vcmVmZXJlbmNlL2phdmEvdXRpbC9Mb2NhbGUuaHRtbFxuICogQHBhcmFtIHs/c3RyaW5nfSBzY3JpcHQgLSBTY3JpcHQuIFRoZSBzY3JpcHQgZmllbGQgaXMgY2FzZSBpbnNlbnNpdGl2ZSBidXQgTG9jYWxlIGFsd2F5cyBjYW5vbmljYWxpemVzIHRvIHRpdGxlIGNhc2UuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFthLXpBLVpdezR9LiBlLmcuIEhhbnMgaW4gemgtSGFucy1DTiA6IGh0dHBzOi8vZGV2ZWxvcGVyLmFuZHJvaWQuY29tL3JlZmVyZW5jZS9qYXZhL3V0aWwvTG9jYWxlLmh0bWxcbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiBpdCBmYWlsZWQgdG8gc2V0IGxvY2FsZSBwcm9wZXJseVxuICovXG5oZWxwZXJzLmVuc3VyZURldmljZUxvY2FsZSA9IGFzeW5jIGZ1bmN0aW9uIGVuc3VyZURldmljZUxvY2FsZSAoYWRiLCBsYW5ndWFnZSwgY291bnRyeSwgc2NyaXB0ID0gbnVsbCkge1xuICBpZiAoIV8uaXNTdHJpbmcobGFuZ3VhZ2UpICYmICFfLmlzU3RyaW5nKGNvdW50cnkpKSB7XG4gICAgbG9nZ2VyLndhcm4oYHNldERldmljZUxhbmd1YWdlQ291bnRyeSByZXF1aXJlcyBsYW5ndWFnZSBvciBjb3VudHJ5LmApO1xuICAgIGxvZ2dlci53YXJuKGBHb3QgbGFuZ3VhZ2U6ICcke2xhbmd1YWdlfScgYW5kIGNvdW50cnk6ICcke2NvdW50cnl9J2ApO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGF3YWl0IGFkYi5zZXREZXZpY2VMYW5ndWFnZUNvdW50cnkobGFuZ3VhZ2UsIGNvdW50cnksIHNjcmlwdCk7XG5cbiAgaWYgKCFhd2FpdCBhZGIuZW5zdXJlQ3VycmVudExvY2FsZShsYW5ndWFnZSwgY291bnRyeSwgc2NyaXB0KSkge1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBzY3JpcHQgPyBgbGFuZ3VhZ2U6ICR7bGFuZ3VhZ2V9LCBjb3VudHJ5OiAke2NvdW50cnl9IGFuZCBzY3JpcHQ6ICR7c2NyaXB0fWAgOiBgbGFuZ3VhZ2U6ICR7bGFuZ3VhZ2V9IGFuZCBjb3VudHJ5OiAke2NvdW50cnl9YDtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBzZXQgJHttZXNzYWdlfWApO1xuICB9XG59O1xuXG5oZWxwZXJzLmdldERldmljZUluZm9Gcm9tQ2FwcyA9IGFzeW5jIGZ1bmN0aW9uIGdldERldmljZUluZm9Gcm9tQ2FwcyAob3B0cyA9IHt9KSB7XG4gIC8vIHdlIGNhbiBjcmVhdGUgYSB0aHJvd2F3YXkgQURCIGluc3RhbmNlIGhlcmUsIHNvIHRoZXJlIGlzIG5vIGRlcGVuZGVuY3lcbiAgLy8gb24gaW5zdGFudGlhdGluZyBvbiBlYXJsaWVyIChhdCB0aGlzIHBvaW50LCB3ZSBoYXZlIG5vIHVkaWQpXG4gIC8vIHdlIGNhbiBvbmx5IHVzZSB0aGlzIEFEQiBvYmplY3QgZm9yIGNvbW1hbmRzIHRoYXQgd291bGQgbm90IGJlIGNvbmZ1c2VkXG4gIC8vIGlmIG11bHRpcGxlIGRldmljZXMgYXJlIGNvbm5lY3RlZFxuICBjb25zdCBhZGIgPSBhd2FpdCBoZWxwZXJzLmNyZWF0ZUJhc2VBREIob3B0cyk7XG4gIGxldCB1ZGlkID0gb3B0cy51ZGlkO1xuICBsZXQgZW1Qb3J0ID0gbnVsbDtcblxuICAvLyBhIHNwZWNpZmljIGF2ZCBuYW1lIHdhcyBnaXZlbi4gdHJ5IHRvIGluaXRpYWxpemUgd2l0aCB0aGF0XG4gIGlmIChvcHRzLmF2ZCkge1xuICAgIGF3YWl0IGhlbHBlcnMucHJlcGFyZUVtdWxhdG9yKGFkYiwgb3B0cyk7XG4gICAgdWRpZCA9IGFkYi5jdXJEZXZpY2VJZDtcbiAgICBlbVBvcnQgPSBhZGIuZW11bGF0b3JQb3J0O1xuICB9IGVsc2Uge1xuICAgIC8vIG5vIGF2ZCBnaXZlbi4gbGV0cyB0cnkgd2hhdGV2ZXIncyBwbHVnZ2VkIGluIGRldmljZXMvZW11bGF0b3JzXG4gICAgbG9nZ2VyLmluZm8oJ1JldHJpZXZpbmcgZGV2aWNlIGxpc3QnKTtcbiAgICBsZXQgZGV2aWNlcyA9IGF3YWl0IGFkYi5nZXREZXZpY2VzV2l0aFJldHJ5KCk7XG5cbiAgICAvLyB1ZGlkIHdhcyBnaXZlbiwgbGV0cyB0cnkgdG8gaW5pdCB3aXRoIHRoYXQgZGV2aWNlXG4gICAgaWYgKHVkaWQpIHtcbiAgICAgIGlmICghXy5pbmNsdWRlcyhfLm1hcChkZXZpY2VzLCAndWRpZCcpLCB1ZGlkKSkge1xuICAgICAgICBsb2dnZXIuZXJyb3JBbmRUaHJvdyhgRGV2aWNlICR7dWRpZH0gd2FzIG5vdCBpbiB0aGUgbGlzdCBvZiBjb25uZWN0ZWQgZGV2aWNlc2ApO1xuICAgICAgfVxuICAgICAgZW1Qb3J0ID0gYWRiLmdldFBvcnRGcm9tRW11bGF0b3JTdHJpbmcodWRpZCk7XG4gICAgfSBlbHNlIGlmIChvcHRzLnBsYXRmb3JtVmVyc2lvbikge1xuICAgICAgb3B0cy5wbGF0Zm9ybVZlcnNpb24gPSBgJHtvcHRzLnBsYXRmb3JtVmVyc2lvbn1gLnRyaW0oKTtcblxuICAgICAgLy8gYSBwbGF0Zm9ybSB2ZXJzaW9uIHdhcyBnaXZlbi4gbGV0cyB0cnkgdG8gZmluZCBhIGRldmljZSB3aXRoIHRoZSBzYW1lIG9zXG4gICAgICBjb25zdCBwbGF0Zm9ybVZlcnNpb24gPSBzZW12ZXIuY29lcmNlKG9wdHMucGxhdGZvcm1WZXJzaW9uKSB8fCBvcHRzLnBsYXRmb3JtVmVyc2lvbjtcbiAgICAgIGxvZ2dlci5pbmZvKGBMb29raW5nIGZvciBhIGRldmljZSB3aXRoIEFuZHJvaWQgJyR7cGxhdGZvcm1WZXJzaW9ufSdgKTtcblxuICAgICAgLy8gaW4gY2FzZSB3ZSBmYWlsIHRvIGZpbmQgc29tZXRoaW5nLCBnaXZlIHRoZSB1c2VyIGEgdXNlZnVsIGxvZyB0aGF0IGhhc1xuICAgICAgLy8gdGhlIGRldmljZSB1ZGlkcyBhbmQgb3MgdmVyc2lvbnMgc28gdGhleSBrbm93IHdoYXQncyBhdmFpbGFibGVcbiAgICAgIGNvbnN0IGF2YWlsRGV2aWNlcyA9IFtdO1xuICAgICAgbGV0IHBhcnRpYWxNYXRjaENhbmRpZGF0ZSA9IG51bGw7XG4gICAgICAvLyBmaXJzdCB0cnkgc3RhcnRlZCBkZXZpY2VzL2VtdWxhdG9yc1xuICAgICAgZm9yIChjb25zdCBkZXZpY2Ugb2YgZGV2aWNlcykge1xuICAgICAgICAvLyBkaXJlY3QgYWRiIGNhbGxzIHRvIHRoZSBzcGVjaWZpYyBkZXZpY2VcbiAgICAgICAgYXdhaXQgYWRiLnNldERldmljZUlkKGRldmljZS51ZGlkKTtcbiAgICAgICAgY29uc3QgcmF3RGV2aWNlT1MgPSBhd2FpdCBhZGIuZ2V0UGxhdGZvcm1WZXJzaW9uKCk7XG4gICAgICAgIC8vIFRoZSBkZXZpY2UgT1MgY291bGQgZWl0aGVyIGJlIGEgbnVtYmVyLCBsaWtlIGA2LjBgXG4gICAgICAgIC8vIG9yIGFuIGFiYnJldmlhdGlvbiwgbGlrZSBgUmBcbiAgICAgICAgYXZhaWxEZXZpY2VzLnB1c2goYCR7ZGV2aWNlLnVkaWR9ICgke3Jhd0RldmljZU9TfSlgKTtcbiAgICAgICAgY29uc3QgZGV2aWNlT1MgPSBzZW12ZXIuY29lcmNlKHJhd0RldmljZU9TKSB8fCByYXdEZXZpY2VPUztcbiAgICAgICAgaWYgKCFkZXZpY2VPUykge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgYm90aFZlcnNpb25zQ2FuQmVDb2VyY2VkID0gc2VtdmVyLnZhbGlkKGRldmljZU9TKSAmJiBzZW12ZXIudmFsaWQocGxhdGZvcm1WZXJzaW9uKTtcbiAgICAgICAgY29uc3QgYm90aFZlcnNpb25zQXJlU3RyaW5ncyA9IF8uaXNTdHJpbmcoZGV2aWNlT1MpICYmIF8uaXNTdHJpbmcocGxhdGZvcm1WZXJzaW9uKTtcbiAgICAgICAgaWYgKGJvdGhWZXJzaW9uc0NhbkJlQ29lcmNlZCAmJiBkZXZpY2VPUy52ZXJzaW9uID09PSBwbGF0Zm9ybVZlcnNpb24udmVyc2lvblxuICAgICAgICAgICAgfHwgYm90aFZlcnNpb25zQXJlU3RyaW5ncyAmJiBfLnRvTG93ZXIoZGV2aWNlT1MpID09PSBfLnRvTG93ZXIocGxhdGZvcm1WZXJzaW9uKSkge1xuICAgICAgICAgIC8vIEdvdCBhbiBleGFjdCBtYXRjaCAtIHByb2NlZWQgaW1tZWRpYXRlbHlcbiAgICAgICAgICB1ZGlkID0gZGV2aWNlLnVkaWQ7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH0gZWxzZSBpZiAoIWJvdGhWZXJzaW9uc0NhbkJlQ29lcmNlZCkge1xuICAgICAgICAgIC8vIFRoZXJlIGlzIG5vIHBvaW50IHRvIGNoZWNrIGZvciBwYXJ0aWFsIG1hdGNoIGlmIGVpdGhlciBvZiB2ZXJzaW9uIG51bWJlcnMgaXMgbm90IGNvZXJjaWJsZVxuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCghXy5pbmNsdWRlcyhvcHRzLnBsYXRmb3JtVmVyc2lvbiwgJy4nKSAmJiBwbGF0Zm9ybVZlcnNpb24ubWFqb3IgPT09IGRldmljZU9TLm1ham9yXG4gICAgICAgICAgICB8fCBwbGF0Zm9ybVZlcnNpb24ubWFqb3IgPT09IGRldmljZU9TLm1ham9yICYmIHBsYXRmb3JtVmVyc2lvbi5taW5vciA9PT0gZGV2aWNlT1MubWlub3IpXG4gICAgICAgICAgICAvLyBHb3QgYSBwYXJ0aWFsIG1hdGNoIC0gbWFrZSBzdXJlIHdlIGNvbnNpZGVyIHRoZSBtb3N0IHJlY2VudFxuICAgICAgICAgICAgLy8gZGV2aWNlIHZlcnNpb24gYXZhaWxhYmxlIG9uIHRoZSBob3N0IHN5c3RlbVxuICAgICAgICAgICAgJiYgKHBhcnRpYWxNYXRjaENhbmRpZGF0ZSAmJiBzZW12ZXIuZ3QoZGV2aWNlT1MsIF8udmFsdWVzKHBhcnRpYWxNYXRjaENhbmRpZGF0ZSlbMF0pXG4gICAgICAgICAgICAgICAgfHwgIXBhcnRpYWxNYXRjaENhbmRpZGF0ZSkpIHtcbiAgICAgICAgICBwYXJ0aWFsTWF0Y2hDYW5kaWRhdGUgPSB7W2RldmljZS51ZGlkXTogZGV2aWNlT1N9O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoIXVkaWQgJiYgcGFydGlhbE1hdGNoQ2FuZGlkYXRlKSB7XG4gICAgICAgIHVkaWQgPSBfLmtleXMocGFydGlhbE1hdGNoQ2FuZGlkYXRlKVswXTtcbiAgICAgICAgYXdhaXQgYWRiLnNldERldmljZUlkKHVkaWQpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXVkaWQpIHtcbiAgICAgICAgLy8gd2UgY291bGRuJ3QgZmluZCBhbnl0aGluZyEgcXVpdFxuICAgICAgICBsb2dnZXIuZXJyb3JBbmRUaHJvdyhgVW5hYmxlIHRvIGZpbmQgYW4gYWN0aXZlIGRldmljZSBvciBlbXVsYXRvciBgICtcbiAgICAgICAgICBgd2l0aCBPUyAke29wdHMucGxhdGZvcm1WZXJzaW9ufS4gVGhlIGZvbGxvd2luZyBhcmUgYXZhaWxhYmxlOiBgICtcbiAgICAgICAgICBhdmFpbERldmljZXMuam9pbignLCAnKSk7XG4gICAgICB9XG5cbiAgICAgIGVtUG9ydCA9IGFkYi5nZXRQb3J0RnJvbUVtdWxhdG9yU3RyaW5nKHVkaWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBhIHVkaWQgd2FzIG5vdCBnaXZlbiwgZ3JhYiB0aGUgZmlyc3QgZGV2aWNlIHdlIHNlZVxuICAgICAgdWRpZCA9IGRldmljZXNbMF0udWRpZDtcbiAgICAgIGVtUG9ydCA9IGFkYi5nZXRQb3J0RnJvbUVtdWxhdG9yU3RyaW5nKHVkaWQpO1xuICAgIH1cbiAgfVxuXG4gIGxvZ2dlci5pbmZvKGBVc2luZyBkZXZpY2U6ICR7dWRpZH1gKTtcbiAgcmV0dXJuIHt1ZGlkLCBlbVBvcnR9O1xufTtcblxuLy8gcmV0dXJucyBhIG5ldyBhZGIgaW5zdGFuY2Ugd2l0aCBkZXZpY2VJZCBzZXRcbmhlbHBlcnMuY3JlYXRlQURCID0gYXN5bmMgZnVuY3Rpb24gY3JlYXRlQURCIChvcHRzID0ge30pIHtcbiAgY29uc3Qge3VkaWQsIGVtUG9ydH0gPSBvcHRzO1xuICBjb25zdCBhZGIgPSBhd2FpdCBoZWxwZXJzLmNyZWF0ZUJhc2VBREIob3B0cyk7XG4gIGFkYi5zZXREZXZpY2VJZCh1ZGlkKTtcbiAgaWYgKGVtUG9ydCkge1xuICAgIGFkYi5zZXRFbXVsYXRvclBvcnQoZW1Qb3J0KTtcbiAgfVxuXG4gIHJldHVybiBhZGI7XG59O1xuXG5oZWxwZXJzLnZhbGlkYXRlUGFja2FnZUFjdGl2aXR5TmFtZXMgPSBmdW5jdGlvbiB2YWxpZGF0ZVBhY2thZ2VBY3Rpdml0eU5hbWVzIChvcHRzKSB7XG4gIGZvciAoY29uc3Qga2V5IG9mIFsnYXBwUGFja2FnZScsICdhcHBBY3Rpdml0eScsICdhcHBXYWl0UGFja2FnZScsICdhcHBXYWl0QWN0aXZpdHknXSkge1xuICAgIGNvbnN0IG5hbWUgPSBvcHRzW2tleV07XG4gICAgaWYgKCFuYW1lKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBjb25zdCBtYXRjaCA9IC8oW15cXHcuKixdKSsvLmV4ZWMobmFtZSk7XG4gICAgaWYgKCFtYXRjaCkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgbG9nZ2VyLndhcm4oYENhcGFiaWxpdHkgJyR7a2V5fScgaXMgZXhwZWN0ZWQgdG8gb25seSBpbmNsdWRlIGxhdGluIGxldHRlcnMsIGRpZ2l0cywgdW5kZXJzY29yZSwgZG90LCBjb21tYSBhbmQgYXN0ZXJpc2sgY2hhcmFjdGVycy5gKTtcbiAgICBsb2dnZXIud2FybihgQ3VycmVudCB2YWx1ZSAnJHtuYW1lfScgaGFzIG5vbi1tYXRjaGluZyBjaGFyYWN0ZXIgYXQgaW5kZXggJHttYXRjaC5pbmRleH06ICcke25hbWUuc3Vic3RyaW5nKDAsIG1hdGNoLmluZGV4ICsgMSl9J2ApO1xuICB9XG59O1xuXG5oZWxwZXJzLmdldExhdW5jaEluZm8gPSBhc3luYyBmdW5jdGlvbiBnZXRMYXVuY2hJbmZvIChhZGIsIG9wdHMpIHtcbiAgbGV0IHthcHAsIGFwcFBhY2thZ2UsIGFwcEFjdGl2aXR5LCBhcHBXYWl0UGFja2FnZSwgYXBwV2FpdEFjdGl2aXR5fSA9IG9wdHM7XG4gIGlmICghYXBwKSB7XG4gICAgbG9nZ2VyLndhcm4oJ05vIGFwcCBzZW50IGluLCBub3QgcGFyc2luZyBwYWNrYWdlL2FjdGl2aXR5Jyk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdGhpcy52YWxpZGF0ZVBhY2thZ2VBY3Rpdml0eU5hbWVzKG9wdHMpO1xuXG4gIGlmIChhcHBQYWNrYWdlICYmIGFwcEFjdGl2aXR5KSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbG9nZ2VyLmRlYnVnKCdQYXJzaW5nIHBhY2thZ2UgYW5kIGFjdGl2aXR5IGZyb20gYXBwIG1hbmlmZXN0Jyk7XG4gIGxldCB7YXBrUGFja2FnZSwgYXBrQWN0aXZpdHl9ID1cbiAgICBhd2FpdCBhZGIucGFja2FnZUFuZExhdW5jaEFjdGl2aXR5RnJvbU1hbmlmZXN0KGFwcCk7XG4gIGlmIChhcGtQYWNrYWdlICYmICFhcHBQYWNrYWdlKSB7XG4gICAgYXBwUGFja2FnZSA9IGFwa1BhY2thZ2U7XG4gIH1cbiAgaWYgKCFhcHBXYWl0UGFja2FnZSkge1xuICAgIGFwcFdhaXRQYWNrYWdlID0gYXBwUGFja2FnZTtcbiAgfVxuICBpZiAoYXBrQWN0aXZpdHkgJiYgIWFwcEFjdGl2aXR5KSB7XG4gICAgYXBwQWN0aXZpdHkgPSBhcGtBY3Rpdml0eTtcbiAgfVxuICBpZiAoIWFwcFdhaXRBY3Rpdml0eSkge1xuICAgIGFwcFdhaXRBY3Rpdml0eSA9IGFwcEFjdGl2aXR5O1xuICB9XG4gIGxvZ2dlci5kZWJ1ZyhgUGFyc2VkIHBhY2thZ2UgYW5kIGFjdGl2aXR5IGFyZTogJHthcGtQYWNrYWdlfS8ke2Fwa0FjdGl2aXR5fWApO1xuICByZXR1cm4ge2FwcFBhY2thZ2UsIGFwcFdhaXRQYWNrYWdlLCBhcHBBY3Rpdml0eSwgYXBwV2FpdEFjdGl2aXR5fTtcbn07XG5cbmhlbHBlcnMucmVzZXRBcHAgPSBhc3luYyBmdW5jdGlvbiByZXNldEFwcCAoYWRiLCBvcHRzID0ge30pIHtcbiAgY29uc3Qge1xuICAgIGFwcCxcbiAgICBhcHBQYWNrYWdlLFxuICAgIGZhc3RSZXNldCxcbiAgICBmdWxsUmVzZXQsXG4gICAgYW5kcm9pZEluc3RhbGxUaW1lb3V0ID0gUEFDS0FHRV9JTlNUQUxMX1RJTUVPVVQsXG4gICAgYXV0b0dyYW50UGVybWlzc2lvbnMsXG4gICAgYWxsb3dUZXN0UGFja2FnZXNcbiAgfSA9IG9wdHM7XG5cbiAgaWYgKCFhcHBQYWNrYWdlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiJ2FwcFBhY2thZ2UnIG9wdGlvbiBpcyByZXF1aXJlZFwiKTtcbiAgfVxuXG4gIGNvbnN0IGlzSW5zdGFsbGVkID0gYXdhaXQgYWRiLmlzQXBwSW5zdGFsbGVkKGFwcFBhY2thZ2UpO1xuXG4gIGlmIChpc0luc3RhbGxlZCkge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBhZGIuZm9yY2VTdG9wKGFwcFBhY2thZ2UpO1xuICAgIH0gY2F0Y2ggKGlnbikge31cbiAgICAvLyBmdWxsUmVzZXQgaGFzIHByaW9yaXR5IG92ZXIgZmFzdFJlc2V0XG4gICAgaWYgKCFmdWxsUmVzZXQgJiYgZmFzdFJlc2V0KSB7XG4gICAgICBjb25zdCBvdXRwdXQgPSBhd2FpdCBhZGIuY2xlYXIoYXBwUGFja2FnZSk7XG4gICAgICBpZiAoXy5pc1N0cmluZyhvdXRwdXQpICYmIG91dHB1dC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdmYWlsZWQnKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCBjbGVhciB0aGUgYXBwbGljYXRpb24gZGF0YSBvZiAnJHthcHBQYWNrYWdlfScuIE9yaWdpbmFsIGVycm9yOiAke291dHB1dH1gKTtcbiAgICAgIH1cbiAgICAgIC8vIGV4ZWN1dGluZyBgc2hlbGwgcG0gY2xlYXJgIHJlc2V0cyBwcmV2aW91c2x5IGFzc2lnbmVkIGFwcGxpY2F0aW9uIHBlcm1pc3Npb25zIGFzIHdlbGxcbiAgICAgIGlmIChhdXRvR3JhbnRQZXJtaXNzaW9ucykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IGFkYi5ncmFudEFsbFBlcm1pc3Npb25zKGFwcFBhY2thZ2UpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGxvZ2dlci5lcnJvcihgVW5hYmxlIHRvIGdyYW50IHBlcm1pc3Npb25zIHJlcXVlc3RlZC4gT3JpZ2luYWwgZXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgbG9nZ2VyLmRlYnVnKGBQZXJmb3JtZWQgZmFzdCByZXNldCBvbiB0aGUgaW5zdGFsbGVkICcke2FwcFBhY2thZ2V9JyBhcHBsaWNhdGlvbiAoc3RvcCBhbmQgY2xlYXIpYCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG5cbiAgaWYgKCFhcHApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCInYXBwJyBvcHRpb24gaXMgcmVxdWlyZWQgZm9yIHJlaW5zdGFsbFwiKTtcbiAgfVxuXG4gIGxvZ2dlci5kZWJ1ZyhgUnVubmluZyBmdWxsIHJlc2V0IG9uICcke2FwcFBhY2thZ2V9JyAocmVpbnN0YWxsKWApO1xuICBpZiAoaXNJbnN0YWxsZWQpIHtcbiAgICBhd2FpdCBhZGIudW5pbnN0YWxsQXBrKGFwcFBhY2thZ2UpO1xuICB9XG4gIGF3YWl0IGFkYi5pbnN0YWxsKGFwcCwge1xuICAgIGdyYW50UGVybWlzc2lvbnM6IGF1dG9HcmFudFBlcm1pc3Npb25zLFxuICAgIHRpbWVvdXQ6IGFuZHJvaWRJbnN0YWxsVGltZW91dCxcbiAgICBhbGxvd1Rlc3RQYWNrYWdlcyxcbiAgfSk7XG59O1xuXG5oZWxwZXJzLmluc3RhbGxBcGsgPSBhc3luYyBmdW5jdGlvbiBpbnN0YWxsQXBrIChhZGIsIG9wdHMgPSB7fSkge1xuICBjb25zdCB7XG4gICAgYXBwLFxuICAgIGFwcFBhY2thZ2UsXG4gICAgZmFzdFJlc2V0LFxuICAgIGZ1bGxSZXNldCxcbiAgICBhbmRyb2lkSW5zdGFsbFRpbWVvdXQgPSBQQUNLQUdFX0lOU1RBTExfVElNRU9VVCxcbiAgICBhdXRvR3JhbnRQZXJtaXNzaW9ucyxcbiAgICBhbGxvd1Rlc3RQYWNrYWdlcyxcbiAgICBlbmZvcmNlQXBwSW5zdGFsbCxcbiAgfSA9IG9wdHM7XG5cbiAgaWYgKCFhcHAgfHwgIWFwcFBhY2thZ2UpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCInYXBwJyBhbmQgJ2FwcFBhY2thZ2UnIG9wdGlvbnMgYXJlIHJlcXVpcmVkXCIpO1xuICB9XG5cbiAgaWYgKGZ1bGxSZXNldCkge1xuICAgIGF3YWl0IHRoaXMucmVzZXRBcHAoYWRiLCBvcHRzKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCB7XG4gICAgYXBwU3RhdGUsXG4gICAgd2FzVW5pbnN0YWxsZWRcbiAgfSA9IGF3YWl0IGFkYi5pbnN0YWxsT3JVcGdyYWRlKGFwcCwgYXBwUGFja2FnZSwge1xuICAgIGdyYW50UGVybWlzc2lvbnM6IGF1dG9HcmFudFBlcm1pc3Npb25zLFxuICAgIHRpbWVvdXQ6IGFuZHJvaWRJbnN0YWxsVGltZW91dCxcbiAgICBhbGxvd1Rlc3RQYWNrYWdlcyxcbiAgICBlbmZvcmNlQ3VycmVudEJ1aWxkOiBlbmZvcmNlQXBwSW5zdGFsbCxcbiAgfSk7XG5cbiAgLy8gVGhlcmUgaXMgbm8gbmVlZCB0byByZXNldCB0aGUgbmV3bHkgaW5zdGFsbGVkIGFwcFxuICBjb25zdCBpc0luc3RhbGxlZE92ZXJFeGlzdGluZ0FwcCA9ICF3YXNVbmluc3RhbGxlZFxuICAgICYmIGFwcFN0YXRlICE9PSBhZGIuQVBQX0lOU1RBTExfU1RBVEUuTk9UX0lOU1RBTExFRDtcbiAgaWYgKGZhc3RSZXNldCAmJiBpc0luc3RhbGxlZE92ZXJFeGlzdGluZ0FwcCkge1xuICAgIGxvZ2dlci5pbmZvKGBQZXJmb3JtaW5nIGZhc3QgcmVzZXQgb24gJyR7YXBwUGFja2FnZX0nYCk7XG4gICAgYXdhaXQgdGhpcy5yZXNldEFwcChhZGIsIG9wdHMpO1xuICB9XG59O1xuXG4vKipcbiAqIEluc3RhbGxzIGFuIGFycmF5IG9mIGFwa3NcbiAqIEBwYXJhbSB7QURCfSBhZGIgSW5zdGFuY2Ugb2YgQXBwaXVtIEFEQiBvYmplY3RcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRzIE9wdHMgZGVmaW5lZCBpbiBkcml2ZXIuanNcbiAqL1xuaGVscGVycy5pbnN0YWxsT3RoZXJBcGtzID0gYXN5bmMgZnVuY3Rpb24gaW5zdGFsbE90aGVyQXBrcyAob3RoZXJBcHBzLCBhZGIsIG9wdHMpIHtcbiAgbGV0IHtcbiAgICBhbmRyb2lkSW5zdGFsbFRpbWVvdXQgPSBQQUNLQUdFX0lOU1RBTExfVElNRU9VVCxcbiAgICBhdXRvR3JhbnRQZXJtaXNzaW9ucyxcbiAgICBhbGxvd1Rlc3RQYWNrYWdlc1xuICB9ID0gb3B0cztcblxuICAvLyBJbnN0YWxsIGFsbCBvZiB0aGUgQVBLJ3MgYXN5bmNocm9ub3VzbHlcbiAgYXdhaXQgQi5hbGwob3RoZXJBcHBzLm1hcCgob3RoZXJBcHApID0+IHtcbiAgICBsb2dnZXIuZGVidWcoYEluc3RhbGxpbmcgYXBwOiAke290aGVyQXBwfWApO1xuICAgIHJldHVybiBhZGIuaW5zdGFsbE9yVXBncmFkZShvdGhlckFwcCwgbnVsbCwge1xuICAgICAgZ3JhbnRQZXJtaXNzaW9uczogYXV0b0dyYW50UGVybWlzc2lvbnMsXG4gICAgICB0aW1lb3V0OiBhbmRyb2lkSW5zdGFsbFRpbWVvdXQsXG4gICAgICBhbGxvd1Rlc3RQYWNrYWdlcyxcbiAgICB9KTtcbiAgfSkpO1xufTtcblxuLyoqXG4gKiBVbmluc3RhbGwgYW4gYXJyYXkgb2YgcGFja2FnZXNcbiAqIEBwYXJhbSB7QURCfSBhZGIgSW5zdGFuY2Ugb2YgQXBwaXVtIEFEQiBvYmplY3RcbiAqIEBwYXJhbSB7QXJyYXk8c3RyaW5nPn0gYXBwUGFja2FnZXMgQW4gYXJyYXkgb2YgcGFja2FnZSBuYW1lcyB0byB1bmluc3RhbGwuIElmIHRoaXMgaW5jbHVkZXMgYCcqJ2AsIHVuaW5zdGFsbCBhbGwgb2YgM3JkIHBhcnR5IGFwcHNcbiAqIEBwYXJhbSB7QXJyYXk8c3RyaW5nPn0gZmlsdGVyUGFja2FnZXMgQW4gYXJyYXkgb2YgcGFja2FnZXMgZG9lcyBub3QgdW5pbnN0YWxsIHdoZW4gYCpgIGlzIHByb3ZpZGVkIGFzIGBhcHBQYWNrYWdlc2BcbiAqL1xuaGVscGVycy51bmluc3RhbGxPdGhlclBhY2thZ2VzID0gYXN5bmMgZnVuY3Rpb24gdW5pbnN0YWxsT3RoZXJQYWNrYWdlcyAoYWRiLCBhcHBQYWNrYWdlcywgZmlsdGVyUGFja2FnZXMgPSBbXSkge1xuICBpZiAoYXBwUGFja2FnZXMuaW5jbHVkZXMoJyonKSkge1xuICAgIGxvZ2dlci5kZWJ1ZygnVW5pbnN0YWxsIHRoaXJkIHBhcnR5IHBhY2thZ2VzJyk7XG4gICAgYXBwUGFja2FnZXMgPSBhd2FpdCB0aGlzLmdldFRoaXJkUGFydHlQYWNrYWdlcyhhZGIsIGZpbHRlclBhY2thZ2VzKTtcbiAgfVxuXG4gIGxvZ2dlci5kZWJ1ZyhgVW5pbnN0YWxsaW5nIHBhY2thZ2VzOiAke2FwcFBhY2thZ2VzfWApO1xuICBhd2FpdCBCLmFsbChhcHBQYWNrYWdlcy5tYXAoKGFwcFBhY2thZ2UpID0+IGFkYi51bmluc3RhbGxBcGsoYXBwUGFja2FnZSkpKTtcbn07XG5cbi8qKlxuICogR2V0IHRoaXJkIHBhcnR5IHBhY2thZ2VzIGZpbHRlcmVkIHdpdGggYGZpbHRlclBhY2thZ2VzYFxuICogQHBhcmFtIHtBREJ9IGFkYiBJbnN0YW5jZSBvZiBBcHBpdW0gQURCIG9iamVjdFxuICogQHBhcmFtIHtBcnJheTxzdHJpbmc+fSBmaWx0ZXJQYWNrYWdlcyBBbiBhcnJheSBvZiBwYWNrYWdlcyBkb2VzIG5vdCB1bmluc3RhbGwgd2hlbiBgKmAgaXMgcHJvdmlkZWQgYXMgYGFwcFBhY2thZ2VzYFxuICogQHJldHVybnMge0FycmF5PHN0cmluZz59IEFuIGFycmF5IG9mIGluc3RhbGxlZCB0aGlyZCBwYXJ5IHBhY2thZ2VzXG4gKi9cbmhlbHBlcnMuZ2V0VGhpcmRQYXJ0eVBhY2thZ2VzID0gYXN5bmMgZnVuY3Rpb24gZ2V0VGhpcmRQYXJ0eVBhY2thZ2VzIChhZGIsIGZpbHRlclBhY2thZ2VzID0gW10pIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwYWNrYWdlc1N0cmluZyA9IGF3YWl0IGFkYi5zaGVsbChbJ3BtJywgJ2xpc3QnLCAncGFja2FnZXMnLCAnLTMnXSk7XG4gICAgY29uc3QgYXBwUGFja2FnZXNBcnJheSA9IHBhY2thZ2VzU3RyaW5nLnRyaW0oKS5yZXBsYWNlKC9wYWNrYWdlOi9nLCAnJykuc3BsaXQoRU9MKTtcbiAgICBsb2dnZXIuZGVidWcoYCcke2FwcFBhY2thZ2VzQXJyYXl9JyBmaWx0ZXJlZCB3aXRoICcke2ZpbHRlclBhY2thZ2VzfSdgKTtcbiAgICByZXR1cm4gXy5kaWZmZXJlbmNlKGFwcFBhY2thZ2VzQXJyYXksIGZpbHRlclBhY2thZ2VzKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgbG9nZ2VyLndhcm4oYFVuYWJsZSB0byBnZXQgcGFja2FnZXMgd2l0aCAnYWRiIHNoZWxsIHBtIGxpc3QgcGFja2FnZXMgLTMnOiAke2Vyci5tZXNzYWdlfWApO1xuICAgIHJldHVybiBbXTtcbiAgfVxufTtcblxuaGVscGVycy5pbml0VW5pY29kZUtleWJvYXJkID0gYXN5bmMgZnVuY3Rpb24gaW5pdFVuaWNvZGVLZXlib2FyZCAoYWRiKSB7XG4gIGxvZ2dlci5kZWJ1ZygnRW5hYmxpbmcgVW5pY29kZSBrZXlib2FyZCBzdXBwb3J0Jyk7XG5cbiAgLy8gZ2V0IHRoZSBkZWZhdWx0IElNRSBzbyB3ZSBjYW4gcmV0dXJuIGJhY2sgdG8gaXQgbGF0ZXIgaWYgd2Ugd2FudFxuICBsZXQgZGVmYXVsdElNRSA9IGF3YWl0IGFkYi5kZWZhdWx0SU1FKCk7XG5cbiAgbG9nZ2VyLmRlYnVnKGBVbnNldHRpbmcgcHJldmlvdXMgSU1FICR7ZGVmYXVsdElNRX1gKTtcbiAgY29uc3QgYXBwaXVtSU1FID0gYCR7U0VUVElOR1NfSEVMUEVSX1BLR19JRH0vLlVuaWNvZGVJTUVgO1xuICBsb2dnZXIuZGVidWcoYFNldHRpbmcgSU1FIHRvICcke2FwcGl1bUlNRX0nYCk7XG4gIGF3YWl0IGFkYi5lbmFibGVJTUUoYXBwaXVtSU1FKTtcbiAgYXdhaXQgYWRiLnNldElNRShhcHBpdW1JTUUpO1xuICByZXR1cm4gZGVmYXVsdElNRTtcbn07XG5cbmhlbHBlcnMuc2V0TW9ja0xvY2F0aW9uQXBwID0gYXN5bmMgZnVuY3Rpb24gc2V0TW9ja0xvY2F0aW9uQXBwIChhZGIsIGFwcCkge1xuICB0cnkge1xuICAgIGlmIChhd2FpdCBhZGIuZ2V0QXBpTGV2ZWwoKSA8IDIzKSB7XG4gICAgICBhd2FpdCBhZGIuc2hlbGwoWydzZXR0aW5ncycsICdwdXQnLCAnc2VjdXJlJywgJ21vY2tfbG9jYXRpb24nLCAnMSddKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgYWRiLnNoZWxsKFsnYXBwb3BzJywgJ3NldCcsIGFwcCwgJ2FuZHJvaWQ6bW9ja19sb2NhdGlvbicsICdhbGxvdyddKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGxvZ2dlci53YXJuKGBVbmFibGUgdG8gc2V0IG1vY2sgbG9jYXRpb24gZm9yIGFwcCAnJHthcHB9JzogJHtlcnIubWVzc2FnZX1gKTtcbiAgICByZXR1cm47XG4gIH1cbiAgdHJ5IHtcbiAgICBsZXQgcGtnSWRzID0gW107XG4gICAgaWYgKGF3YWl0IGFkYi5maWxlRXhpc3RzKE1PQ0tfQVBQX0lEU19TVE9SRSkpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHBrZ0lkcyA9IEpTT04ucGFyc2UoYXdhaXQgYWRiLnNoZWxsKFsnY2F0JywgTU9DS19BUFBfSURTX1NUT1JFXSkpO1xuICAgICAgfSBjYXRjaCAoaWduKSB7fVxuICAgIH1cbiAgICBpZiAocGtnSWRzLmluY2x1ZGVzKGFwcCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcGtnSWRzLnB1c2goYXBwKTtcbiAgICBjb25zdCB0bXBSb290ID0gYXdhaXQgdGVtcERpci5vcGVuRGlyKCk7XG4gICAgY29uc3Qgc3JjUGF0aCA9IHBhdGgucG9zaXguam9pbih0bXBSb290LCBwYXRoLnBvc2l4LmJhc2VuYW1lKE1PQ0tfQVBQX0lEU19TVE9SRSkpO1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBmcy53cml0ZUZpbGUoc3JjUGF0aCwgSlNPTi5zdHJpbmdpZnkocGtnSWRzKSwgJ3V0ZjgnKTtcbiAgICAgIGF3YWl0IGFkYi5wdXNoRmlsZShzcmNQYXRoLCBNT0NLX0FQUF9JRFNfU1RPUkUpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBhd2FpdCBmcy5yaW1yYWYodG1wUm9vdCk7XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgbG9nZ2VyLndhcm4oYFVuYWJsZSB0byBwZXJzaXN0IG1vY2sgbG9jYXRpb24gYXBwIGlkICcke2FwcH0nOiAke2UubWVzc2FnZX1gKTtcbiAgfVxufTtcblxuaGVscGVycy5yZXNldE1vY2tMb2NhdGlvbiA9IGFzeW5jIGZ1bmN0aW9uIHJlc2V0TW9ja0xvY2F0aW9uIChhZGIpIHtcbiAgdHJ5IHtcbiAgICBpZiAoYXdhaXQgYWRiLmdldEFwaUxldmVsKCkgPCAyMykge1xuICAgICAgYXdhaXQgYWRiLnNoZWxsKFsnc2V0dGluZ3MnLCAncHV0JywgJ3NlY3VyZScsICdtb2NrX2xvY2F0aW9uJywgJzAnXSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgdGhpcmRQYXJ0eVBrZ0lkc1Byb21pc2UgPSBoZWxwZXJzLmdldFRoaXJkUGFydHlQYWNrYWdlcyhhZGIpO1xuICAgIGxldCBwa2dJZHMgPSBbXTtcbiAgICBpZiAoYXdhaXQgYWRiLmZpbGVFeGlzdHMoTU9DS19BUFBfSURTX1NUT1JFKSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcGtnSWRzID0gSlNPTi5wYXJzZShhd2FpdCBhZGIuc2hlbGwoWydjYXQnLCBNT0NLX0FQUF9JRFNfU1RPUkVdKSk7XG4gICAgICB9IGNhdGNoIChpZ24pIHt9XG4gICAgfVxuICAgIGNvbnN0IHRoaXJkUGFydHlQa2dJZHMgPSBhd2FpdCB0aGlyZFBhcnR5UGtnSWRzUHJvbWlzZTtcbiAgICAvLyBPbmx5IGluY2x1ZGUgY3VycmVudGx5IGluc3RhbGxlZCBwYWNrYWdlc1xuICAgIGNvbnN0IHJlc3VsdFBrZ3MgPSBfLmludGVyc2VjdGlvbihwa2dJZHMsIHRoaXJkUGFydHlQa2dJZHMpO1xuICAgIGlmIChfLnNpemUocmVzdWx0UGtncykgPD0gMSkge1xuICAgICAgYXdhaXQgYWRiLnNoZWxsKFsnYXBwb3BzJywgJ3NldCcsIHJlc3VsdFBrZ3NbMF0gPz8gU0VUVElOR1NfSEVMUEVSX1BLR19JRCwgJ2FuZHJvaWQ6bW9ja19sb2NhdGlvbicsICdkZW55J10pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxvZ2dlci5kZWJ1ZyhgUmVzZXR0aW5nIG1vY2tfbG9jYXRpb24gcGVybWlzc2lvbiBmb3IgdGhlIGZvbGxvd2luZyBhcHBzOiAke3Jlc3VsdFBrZ3N9YCk7XG4gICAgYXdhaXQgQi5hbGwocmVzdWx0UGtncy5tYXAoKHBrZ0lkKSA9PiAoYXN5bmMgKCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgYWRiLnNoZWxsKFsnYXBwb3BzJywgJ3NldCcsIHBrZ0lkLCAnYW5kcm9pZDptb2NrX2xvY2F0aW9uJywgJ2RlbnknXSk7XG4gICAgICB9IGNhdGNoIChpZ24pIHt9XG4gICAgfSkoKSkpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBsb2dnZXIud2FybihgVW5hYmxlIHRvIHJlc2V0IG1vY2sgbG9jYXRpb246ICR7ZXJyLm1lc3NhZ2V9YCk7XG4gIH1cbn07XG5cbmhlbHBlcnMuaW5zdGFsbEhlbHBlckFwcCA9IGFzeW5jIGZ1bmN0aW9uIGluc3RhbGxIZWxwZXJBcHAgKGFkYiwgYXBrUGF0aCwgcGFja2FnZUlkKSB7XG4gIC8vIFNvbWV0aW1lcyBhZGIgcHVzaCBvciBhZGIgaW5zdGFsIHRha2UgbW9yZSB0aW1lIHRoYW4gZXhwZWN0ZWQgdG8gaW5zdGFsbCBhbiBhcHBcbiAgLy8gZS5nLiBodHRwczovL2dpdGh1Yi5jb20vYXBwaXVtL2lvLmFwcGl1bS5zZXR0aW5ncy9pc3N1ZXMvNDAjaXNzdWVjb21tZW50LTQ3NjU5MzE3NFxuICBhd2FpdCByZXRyeSgyLCBhc3luYyBmdW5jdGlvbiByZXRyeUluc3RhbGxIZWxwZXJBcHAgKCkge1xuICAgIGF3YWl0IGFkYi5pbnN0YWxsT3JVcGdyYWRlKGFwa1BhdGgsIHBhY2thZ2VJZCwge2dyYW50UGVybWlzc2lvbnM6IHRydWV9KTtcbiAgfSk7XG59O1xuXG4vKipcbiAqIFB1c2hlcyBhbmQgaW5zdGFsbHMgaW8uYXBwaXVtLnNldHRpbmdzIGFwcC5cbiAqIFRocm93cyBhbiBlcnJvciBpZiB0aGUgc2V0dGluZyBhcHAgaXMgcmVxdWlyZWRcbiAqXG4gKiBAcGFyYW0ge0FkYn0gYWRiIC0gVGhlIGFkYiBtb2R1bGUgaW5zdGFuY2UuXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0cyAtIERyaXZlciBvcHRpb25zIGRpY3Rpb25hcnkuXG4gKiBAcGFyYW0ge2Jvb2xlYW59IHRocm93RXJyb3IgW2ZhbHNlXSAtIFdoZXRoZXIgdGhyb3cgYW4gZXJyb3IgaWYgU2V0dGluZ3MgYXBwIGZhaWxzIHRvIHN0YXJ0XG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhyb3dFcnJvciBpcyB0cnVlIGFuZCBzb21ldGhpbmcgaGFwcGVucyBpbiBpbnN0YWxsYXRpb24gc3RlcFxuICovXG5oZWxwZXJzLnB1c2hTZXR0aW5nc0FwcCA9IGFzeW5jIGZ1bmN0aW9uIHB1c2hTZXR0aW5nc0FwcCAoYWRiLCB0aHJvd0Vycm9yID0gZmFsc2UsIG9wdHMgPSB7fSkge1xuICBsb2dnZXIuZGVidWcoJ1B1c2hpbmcgc2V0dGluZ3MgYXBrIHRvIGRldmljZS4uLicpO1xuXG4gIHRyeSB7XG4gICAgYXdhaXQgaGVscGVycy5pbnN0YWxsSGVscGVyQXBwKGFkYiwgc2V0dGluZ3NBcGtQYXRoLCBTRVRUSU5HU19IRUxQRVJfUEtHX0lELCB0aHJvd0Vycm9yKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgaWYgKHRocm93RXJyb3IpIHtcbiAgICAgIHRocm93IGVycjtcbiAgICB9XG5cbiAgICBsb2dnZXIud2FybihgSWdub3JlZCBlcnJvciB3aGlsZSBpbnN0YWxsaW5nICcke3NldHRpbmdzQXBrUGF0aH0nOiBgICtcbiAgICAgICAgICAgICAgICBgJyR7ZXJyLm1lc3NhZ2V9Jy4gRmVhdHVyZXMgdGhhdCByZWx5IG9uIHRoaXMgaGVscGVyIGAgK1xuICAgICAgICAgICAgICAgICdyZXF1aXJlIHRoZSBhcGsgc3VjaCBhcyB0b2dnbGUgV2lGaSBhbmQgZ2V0dGluZyBsb2NhdGlvbiAnICtcbiAgICAgICAgICAgICAgICAnd2lsbCByYWlzZSBhbiBlcnJvciBpZiB5b3UgdHJ5IHRvIHVzZSB0aGVtLicpO1xuICB9XG5cbiAgLy8gUmVpbnN0YWxsIHdvdWxkIHN0b3AgdGhlIHNldHRpbmdzIGhlbHBlciBwcm9jZXNzIGFueXdheSwgc29cbiAgLy8gdGhlcmUgaXMgbm8gbmVlZCB0byBjb250aW51ZSBpZiB0aGUgYXBwbGljYXRpb24gaXMgc3RpbGwgcnVubmluZ1xuICBpZiAoYXdhaXQgYWRiLnByb2Nlc3NFeGlzdHMoU0VUVElOR1NfSEVMUEVSX1BLR19JRCkpIHtcbiAgICBsb2dnZXIuZGVidWcoYCR7U0VUVElOR1NfSEVMUEVSX1BLR19JRH0gaXMgYWxyZWFkeSBydW5uaW5nLiBgICtcbiAgICAgIGBUaGVyZSBpcyBubyBuZWVkIHRvIHJlc2V0IGl0cyBwZXJtaXNzaW9ucy5gKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBhcGlMZXZlbCA9IGF3YWl0IGFkYi5nZXRBcGlMZXZlbCgpO1xuICBpZiAoYXBpTGV2ZWwgPj0gMjkpIHtcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vYXBwaXVtL2lvLmFwcGl1bS5zZXR0aW5ncyNpbnRlcm5hbC1hdWRpby0tdmlkZW8tcmVjb3JkaW5nXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGFkYi5zaGVsbChbJ2FwcG9wcycsICdzZXQnLCBTRVRUSU5HU19IRUxQRVJfUEtHX0lELCAnUFJPSkVDVF9NRURJQScsICdhbGxvdyddKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGxvZ2dlci5kZWJ1ZyhlcnIpO1xuICAgIH1cbiAgfVxuICBpZiAoYXBpTGV2ZWwgPD0gMjMpIHsgLy8gQW5kcm9pZCA2LSBkZXZpY2VzIHNob3VsZCBoYXZlIGdyYW50ZWQgcGVybWlzc2lvbnNcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vYXBwaXVtL2FwcGl1bS9wdWxsLzExNjQwI2lzc3VlY29tbWVudC00MzgyNjA0NzdcbiAgICBjb25zdCBwZXJtcyA9IFsnU0VUX0FOSU1BVElPTl9TQ0FMRScsICdDSEFOR0VfQ09ORklHVVJBVElPTicsICdBQ0NFU1NfRklORV9MT0NBVElPTiddO1xuICAgIGxvZ2dlci5pbmZvKGBHcmFudGluZyBwZXJtaXNzaW9ucyAke3Blcm1zfSB0byAnJHtTRVRUSU5HU19IRUxQRVJfUEtHX0lEfSdgKTtcbiAgICBhd2FpdCBhZGIuZ3JhbnRQZXJtaXNzaW9ucyhTRVRUSU5HU19IRUxQRVJfUEtHX0lELCBwZXJtcy5tYXAoKHgpID0+IGBhbmRyb2lkLnBlcm1pc3Npb24uJHt4fWApKTtcbiAgfVxuXG4gIC8vIGxhdW5jaCBpby5hcHBpdW0uc2V0dGluZ3MgYXBwIGR1ZSB0byBzZXR0aW5ncyBmYWlsaW5nIHRvIGJlIHNldFxuICAvLyBpZiB0aGUgYXBwIGlzIG5vdCBsYXVuY2hlZCBwcmlvciB0byBzdGFydCB0aGUgc2Vzc2lvbiBvbiBhbmRyb2lkIDcrXG4gIC8vIHNlZSBodHRwczovL2dpdGh1Yi5jb20vYXBwaXVtL2FwcGl1bS9pc3N1ZXMvODk1N1xuICB0cnkge1xuICAgIGF3YWl0IGFkYi5yZXF1aXJlUnVubmluZ1NldHRpbmdzQXBwKHtcbiAgICAgIHRpbWVvdXQ6IGhlbHBlcnMuaXNFbXVsYXRvcihhZGIsIG9wdHMpID8gMzAwMDAgOiA1MDAwXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGxvZ2dlci5kZWJ1ZyhlcnIpO1xuICAgIGlmICh0aHJvd0Vycm9yKSB7XG4gICAgICB0aHJvdyBlcnI7XG4gICAgfVxuICB9XG59O1xuXG4vKipcbiAqIEV4dHJhY3RzIHN0cmluZy54bWwgYW5kIGNvbnZlcnRzIGl0IHRvIHN0cmluZy5qc29uIGFuZCBwdXNoZXNcbiAqIGl0IHRvIC9kYXRhL2xvY2FsL3RtcC9zdHJpbmcuanNvbiBvbiBmb3IgdXNlIG9mIGJvb3RzdHJhcFxuICogSWYgYXBwIGlzIG5vdCBwcmVzZW50IHRvIGV4dHJhY3Qgc3RyaW5nLnhtbCBpdCBkZWxldGVzIHJlbW90ZSBzdHJpbmdzLmpzb25cbiAqIElmIGFwcCBkb2VzIG5vdCBoYXZlIHN0cmluZ3MueG1sIHdlIHB1c2ggYW4gZW1wdHkganNvbiBvYmplY3QgdG8gcmVtb3RlXG4gKlxuICogQHBhcmFtIHs/c3RyaW5nfSBsYW5ndWFnZSAtIExhbmd1YWdlIGFiYnJldmlhdGlvbiwgZm9yIGV4YW1wbGUgJ2ZyJy4gVGhlIGRlZmF1bHQgbGFuZ3VhZ2VcbiAqIGlzIHVzZWQgaWYgdGhpcyBhcmd1bWVudCBpcyBub3QgZGVmaW5lZC5cbiAqIEBwYXJhbSB7T2JqZWN0fSBhZGIgLSBUaGUgYWRiIG1vZHVsZSBpbnN0YW5jZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRzIC0gRHJpdmVyIG9wdGlvbnMgZGljdGlvbmFyeS5cbiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBkaWN0aW9uYXJ5LCB3aGVyZSBzdHJpbmcgcmVzb3VyY2UgaWRlbnRpZmllcnMgYXJlIGtleXNcbiAqIGFsb25nIHdpdGggdGhlaXIgY29ycmVzcG9uZGluZyB2YWx1ZXMgZm9yIHRoZSBnaXZlbiBsYW5ndWFnZSBvciBhbiBlbXB0eSBvYmplY3RcbiAqIGlmIG5vIG1hdGNoaW5nIHJlc291cmNlcyB3ZXJlIGV4dHJhY3RlZC5cbiAqL1xuaGVscGVycy5wdXNoU3RyaW5ncyA9IGFzeW5jIGZ1bmN0aW9uIHB1c2hTdHJpbmdzIChsYW5ndWFnZSwgYWRiLCBvcHRzKSB7XG4gIGNvbnN0IHJlbW90ZURpciA9ICcvZGF0YS9sb2NhbC90bXAnO1xuICBjb25zdCBzdHJpbmdzSnNvbiA9ICdzdHJpbmdzLmpzb24nO1xuICBjb25zdCByZW1vdGVGaWxlID0gcGF0aC5wb3NpeC5yZXNvbHZlKHJlbW90ZURpciwgc3RyaW5nc0pzb24pO1xuXG4gIC8vIGNsZWFuIHVwIHJlbW90ZSBzdHJpbmcuanNvbiBpZiBwcmVzZW50XG4gIGF3YWl0IGFkYi5yaW1yYWYocmVtb3RlRmlsZSk7XG5cbiAgbGV0IGFwcDtcbiAgdHJ5IHtcbiAgICBhcHAgPSBvcHRzLmFwcCB8fCBhd2FpdCBhZGIucHVsbEFwayhvcHRzLmFwcFBhY2thZ2UsIG9wdHMudG1wRGlyKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgbG9nZ2VyLmluZm8oYEZhaWxlZCB0byBwdWxsIGFuIGFwayBmcm9tICcke29wdHMuYXBwUGFja2FnZX0nIHRvICcke29wdHMudG1wRGlyfScuIE9yaWdpbmFsIGVycm9yOiAke2Vyci5tZXNzYWdlfWApO1xuICB9XG5cbiAgaWYgKF8uaXNFbXB0eShvcHRzLmFwcFBhY2thZ2UpIHx8ICEoYXdhaXQgZnMuZXhpc3RzKGFwcCkpKSB7XG4gICAgbG9nZ2VyLmRlYnVnKGBObyBhcHAgb3IgcGFja2FnZSBzcGVjaWZpZWQuIFJldHVybmluZyBlbXB0eSBzdHJpbmdzYCk7XG4gICAgcmV0dXJuIHt9O1xuICB9XG5cbiAgY29uc3Qgc3RyaW5nc1RtcERpciA9IHBhdGgucmVzb2x2ZShvcHRzLnRtcERpciwgb3B0cy5hcHBQYWNrYWdlKTtcbiAgdHJ5IHtcbiAgICBsb2dnZXIuZGVidWcoJ0V4dHJhY3Rpbmcgc3RyaW5ncyBmcm9tIGFwaycsIGFwcCwgbGFuZ3VhZ2UsIHN0cmluZ3NUbXBEaXIpO1xuICAgIGNvbnN0IHthcGtTdHJpbmdzLCBsb2NhbFBhdGh9ID0gYXdhaXQgYWRiLmV4dHJhY3RTdHJpbmdzRnJvbUFwayhhcHAsIGxhbmd1YWdlLCBzdHJpbmdzVG1wRGlyKTtcbiAgICBhd2FpdCBhZGIucHVzaChsb2NhbFBhdGgsIHJlbW90ZURpcik7XG4gICAgcmV0dXJuIGFwa1N0cmluZ3M7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGxvZ2dlci53YXJuKGBDb3VsZCBub3QgZ2V0IHN0cmluZ3MsIGNvbnRpbnVpbmcgYW55d2F5LiBPcmlnaW5hbCBlcnJvcjogJHtlcnIubWVzc2FnZX1gKTtcbiAgICBhd2FpdCBhZGIuc2hlbGwoJ2VjaG8nLCBbYCd7fScgPiAke3JlbW90ZUZpbGV9YF0pO1xuICB9IGZpbmFsbHkge1xuICAgIGF3YWl0IGZzLnJpbXJhZihzdHJpbmdzVG1wRGlyKTtcbiAgfVxuICByZXR1cm4ge307XG59O1xuXG5oZWxwZXJzLnVubG9ja1dpdGhIZWxwZXJBcHAgPSBhc3luYyBmdW5jdGlvbiB1bmxvY2tXaXRoSGVscGVyQXBwIChhZGIpIHtcbiAgbG9nZ2VyLmluZm8oJ1VubG9ja2luZyBzY3JlZW4nKTtcblxuICAvLyBVbmxvY2sgc3VjY2VlZCB3aXRoIGEgY291cGxlIG9mIHJldHJpZXMuXG4gIGxldCBmaXJzdFJ1biA9IHRydWU7XG4gIGF3YWl0IHJldHJ5KDMsIGFzeW5jIGZ1bmN0aW9uIGxhdW5jaEhlbHBlciAoKSB7XG4gICAgLy8gVG8gcmVkdWNlIGEgdGltZSB0byBjYWxsIGFkYi5pc1NjcmVlbkxvY2tlZCgpIHNpbmNlIGBhZGIgc2hlbGwgZHVtcHN5cyB3aW5kb3dgIGlzIGVhc3kgdG8gaGFuZyBhZGIgY29tbWFuZHNcbiAgICBpZiAoZmlyc3RSdW4pIHtcbiAgICAgIGZpcnN0UnVuID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmICghKGF3YWl0IGFkYi5pc1NjcmVlbkxvY2tlZCgpKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBsb2dnZXIud2FybihgRXJyb3IgaW4gaXNTY3JlZW5Mb2NrZWQ6ICR7ZS5tZXNzYWdlfWApO1xuICAgICAgICBsb2dnZXIud2FybignXCJhZGIgc2hlbGwgZHVtcHN5cyB3aW5kb3dcIiBjb21tYW5kIGhhcyB0aW1lZCBvdXQuJyk7XG4gICAgICAgIGxvZ2dlci53YXJuKCdUaGUgcmVhc29uIG9mIHRoaXMgdGltZW91dCBpcyB0aGUgZGVsYXllZCBhZGIgcmVzcG9uc2UuIFJlc2V0dGluZyBhZGIgc2VydmVyIGNhbiBpbXByb3ZlIGl0LicpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGxvZ2dlci5pbmZvKGBMYXVuY2hpbmcgJHtTRVRUSU5HU19IRUxQRVJfVU5MT0NLX0FDVElWSVRZfWApO1xuICAgIGF3YWl0IGFkYi5zaGVsbChbXG4gICAgICAnYW0nLCAnc3RhcnQnLFxuICAgICAgJy1uJywgYCR7U0VUVElOR1NfSEVMUEVSX1BLR19JRH0vJHtTRVRUSU5HU19IRUxQRVJfVU5MT0NLX0FDVElWSVRZfWAsXG4gICAgICAnLWMnLCAnYW5kcm9pZC5pbnRlbnQuY2F0ZWdvcnkuTEFVTkNIRVInLFxuICAgICAgJy1hJywgJ2FuZHJvaWQuaW50ZW50LmFjdGlvbi5NQUlOJyxcbiAgICAgICctZicsICcweDEwMjAwMDAwJyxcbiAgICBdKTtcbiAgICBhd2FpdCBCLmRlbGF5KDEwMDApO1xuICB9KTtcbn07XG5cbmhlbHBlcnMudW5sb2NrID0gYXN5bmMgZnVuY3Rpb24gdW5sb2NrIChkcml2ZXIsIGFkYiwgY2FwYWJpbGl0aWVzKSB7XG4gIGlmICghKGF3YWl0IGFkYi5pc1NjcmVlbkxvY2tlZCgpKSkge1xuICAgIGxvZ2dlci5pbmZvKCdTY3JlZW4gYWxyZWFkeSB1bmxvY2tlZCwgZG9pbmcgbm90aGluZycpO1xuICAgIHJldHVybjtcbiAgfVxuICBsb2dnZXIuZGVidWcoJ1NjcmVlbiBpcyBsb2NrZWQsIHRyeWluZyB0byB1bmxvY2snKTtcblxuICBpZiAoIWNhcGFiaWxpdGllcy51bmxvY2tUeXBlICYmICFjYXBhYmlsaXRpZXMudW5sb2NrS2V5KSB7XG4gICAgbG9nZ2VyLndhcm4oJ1VzaW5nIGFwcCB1bmxvY2ssIHRoaXMgaXMgZ29pbmcgdG8gYmUgZGVwcmVjYXRlZCEnKTtcbiAgICBhd2FpdCBoZWxwZXJzLnVubG9ja1dpdGhIZWxwZXJBcHAoYWRiKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCB7XG4gICAgdW5sb2NrVHlwZSxcbiAgICB1bmxvY2tLZXksXG4gICAgdW5sb2NrU3RyYXRlZ3ksXG4gICAgdW5sb2NrU3VjY2Vzc1RpbWVvdXQsXG4gIH0gPSB1bmxvY2tlci52YWxpZGF0ZVVubG9ja0NhcGFiaWxpdGllcyhjYXBhYmlsaXRpZXMpO1xuICBpZiAodW5sb2NrS2V5ICYmIHVubG9ja1R5cGUgIT09IEZJTkdFUlBSSU5UX1VOTE9DS1xuICAgICAgJiYgKF8uaXNOaWwodW5sb2NrU3RyYXRlZ3kpIHx8IF8udG9Mb3dlcih1bmxvY2tTdHJhdGVneSkgPT09ICdsb2Nrc2V0dGluZ3MnKVxuICAgICAgJiYgYXdhaXQgYWRiLmlzTG9ja01hbmFnZW1lbnRTdXBwb3J0ZWQoKSkge1xuICAgIGF3YWl0IHVubG9ja2VyLmZhc3RVbmxvY2soYWRiLCB7XG4gICAgICBjcmVkZW50aWFsOiB1bmxvY2tLZXksXG4gICAgICBjcmVkZW50aWFsVHlwZTogdG9DcmVkZW50aWFsVHlwZSh1bmxvY2tUeXBlKSxcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCB1bmxvY2tNZXRob2QgPSB7XG4gICAgICBbUElOX1VOTE9DS106IHVubG9ja2VyLnBpblVubG9jayxcbiAgICAgIFtQSU5fVU5MT0NLX0tFWV9FVkVOVF06IHVubG9ja2VyLnBpblVubG9ja1dpdGhLZXlFdmVudCxcbiAgICAgIFtQQVNTV09SRF9VTkxPQ0tdOiB1bmxvY2tlci5wYXNzd29yZFVubG9jayxcbiAgICAgIFtQQVRURVJOX1VOTE9DS106IHVubG9ja2VyLnBhdHRlcm5VbmxvY2ssXG4gICAgICBbRklOR0VSUFJJTlRfVU5MT0NLXTogdW5sb2NrZXIuZmluZ2VycHJpbnRVbmxvY2ssXG4gICAgfVt1bmxvY2tUeXBlXTtcbiAgICBhd2FpdCB1bmxvY2tNZXRob2QoYWRiLCBkcml2ZXIsIGNhcGFiaWxpdGllcyk7XG4gIH1cbiAgYXdhaXQgaGVscGVycy52ZXJpZnlVbmxvY2soYWRiLCB1bmxvY2tTdWNjZXNzVGltZW91dCk7XG59O1xuXG5oZWxwZXJzLnZlcmlmeVVubG9jayA9IGFzeW5jIGZ1bmN0aW9uIHZlcmlmeVVubG9jayAoYWRiLCB0aW1lb3V0TXMgPSBudWxsKSB7XG4gIHRyeSB7XG4gICAgYXdhaXQgd2FpdEZvckNvbmRpdGlvbihhc3luYyAoKSA9PiAhKGF3YWl0IGFkYi5pc1NjcmVlbkxvY2tlZCgpKSwge1xuICAgICAgd2FpdE1zOiB0aW1lb3V0TXMgPz8gMjAwMCxcbiAgICAgIGludGVydmFsTXM6IDUwMCxcbiAgICB9KTtcbiAgfSBjYXRjaCAoaWduKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgZGV2aWNlIGhhcyBmYWlsZWQgdG8gYmUgdW5sb2NrZWQnKTtcbiAgfVxuICBsb2dnZXIuaW5mbygnVGhlIGRldmljZSBoYXMgYmVlbiBzdWNjZXNzZnVsbHkgdW5sb2NrZWQnKTtcbn07XG5cbmhlbHBlcnMuaW5pdERldmljZSA9IGFzeW5jIGZ1bmN0aW9uIGluaXREZXZpY2UgKGFkYiwgb3B0cykge1xuICBjb25zdCB7XG4gICAgc2tpcERldmljZUluaXRpYWxpemF0aW9uLFxuICAgIGxvY2FsZSxcbiAgICBsYW5ndWFnZSxcbiAgICBsb2NhbGVTY3JpcHQsXG4gICAgdW5pY29kZUtleWJvYXJkLFxuICAgIGRpc2FibGVXaW5kb3dBbmltYXRpb24sXG4gICAgc2tpcFVubG9jayxcbiAgICBtb2NrTG9jYXRpb25BcHAsXG4gICAgc2tpcExvZ2NhdENhcHR1cmUsXG4gICAgbG9nY2F0Rm9ybWF0LFxuICAgIGxvZ2NhdEZpbHRlclNwZWNzLFxuICB9ID0gb3B0cztcblxuICBpZiAoc2tpcERldmljZUluaXRpYWxpemF0aW9uKSB7XG4gICAgbG9nZ2VyLmluZm8oYCdza2lwRGV2aWNlSW5pdGlhbGl6YXRpb24nIGlzIHNldC4gU2tpcHBpbmcgZGV2aWNlIGluaXRpYWxpemF0aW9uLmApO1xuICB9IGVsc2Uge1xuICAgIGF3YWl0IGFkYi53YWl0Rm9yRGV2aWNlKCk7XG4gICAgLy8gcHVzaFNldHRpbmdzQXBwIHJlcXVpcmVkIGJlZm9yZSBjYWxsaW5nIGVuc3VyZURldmljZUxvY2FsZSBmb3IgQVBJIExldmVsIDI0K1xuXG4gICAgLy8gU29tZSBmZWF0dXJlIHN1Y2ggYXMgbG9jYXRpb24vd2lmaSBhcmUgbm90IG5lY2Vzc2FyeSBmb3IgYWxsIHVzZXJzLFxuICAgIC8vIGJ1dCB0aGV5IHJlcXVpcmUgdGhlIHNldHRpbmdzIGFwcC4gU28sIHRyeSB0byBjb25maWd1cmUgaXQgd2hpbGUgQXBwaXVtXG4gICAgLy8gZG9lcyBub3QgdGhyb3cgZXJyb3IgZXZlbiBpZiB0aGV5IGZhaWwuXG4gICAgY29uc3Qgc2hvdWxkVGhyb3dFcnJvciA9IGxhbmd1YWdlXG4gICAgICB8fCBsb2NhbGVcbiAgICAgIHx8IGxvY2FsZVNjcmlwdFxuICAgICAgfHwgdW5pY29kZUtleWJvYXJkXG4gICAgICB8fCBkaXNhYmxlV2luZG93QW5pbWF0aW9uXG4gICAgICB8fCAhc2tpcFVubG9jaztcbiAgICBhd2FpdCBoZWxwZXJzLnB1c2hTZXR0aW5nc0FwcChhZGIsIHNob3VsZFRocm93RXJyb3IsIG9wdHMpO1xuICB9XG5cbiAgaWYgKCFoZWxwZXJzLmlzRW11bGF0b3IoYWRiLCBvcHRzKSkge1xuICAgIGlmIChtb2NrTG9jYXRpb25BcHAgfHwgXy5pc1VuZGVmaW5lZChtb2NrTG9jYXRpb25BcHApKSB7XG4gICAgICBhd2FpdCBoZWxwZXJzLnNldE1vY2tMb2NhdGlvbkFwcChhZGIsIG1vY2tMb2NhdGlvbkFwcCB8fCBTRVRUSU5HU19IRUxQRVJfUEtHX0lEKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgaGVscGVycy5yZXNldE1vY2tMb2NhdGlvbihhZGIpO1xuICAgIH1cbiAgfVxuXG4gIGlmIChsYW5ndWFnZSB8fCBsb2NhbGUpIHtcbiAgICBhd2FpdCBoZWxwZXJzLmVuc3VyZURldmljZUxvY2FsZShhZGIsIGxhbmd1YWdlLCBsb2NhbGUsIGxvY2FsZVNjcmlwdCk7XG4gIH1cblxuICBpZiAoc2tpcExvZ2NhdENhcHR1cmUpIHtcbiAgICBsb2dnZXIuaW5mbyhgJ3NraXBMb2djYXRDYXB0dXJlJyBpcyBzZXQuIFNraXBwaW5nIHN0YXJ0aW5nIGxvZ2NhdCBjYXB0dXJlLmApO1xuICB9IGVsc2Uge1xuICAgIGF3YWl0IGFkYi5zdGFydExvZ2NhdCh7XG4gICAgICBmb3JtYXQ6IGxvZ2NhdEZvcm1hdCxcbiAgICAgIGZpbHRlclNwZWNzOiBsb2djYXRGaWx0ZXJTcGVjcyxcbiAgICB9KTtcbiAgfVxuXG4gIGlmICh1bmljb2RlS2V5Ym9hcmQpIHtcbiAgICByZXR1cm4gYXdhaXQgaGVscGVycy5pbml0VW5pY29kZUtleWJvYXJkKGFkYik7XG4gIH1cbn07XG5cbmhlbHBlcnMucmVtb3ZlTnVsbFByb3BlcnRpZXMgPSBmdW5jdGlvbiByZW1vdmVOdWxsUHJvcGVydGllcyAob2JqKSB7XG4gIGZvciAobGV0IGtleSBvZiBfLmtleXMob2JqKSkge1xuICAgIGlmIChfLmlzTnVsbChvYmpba2V5XSkgfHwgXy5pc1VuZGVmaW5lZChvYmpba2V5XSkpIHtcbiAgICAgIGRlbGV0ZSBvYmpba2V5XTtcbiAgICB9XG4gIH1cbn07XG5cbmhlbHBlcnMudHJ1bmNhdGVEZWNpbWFscyA9IGZ1bmN0aW9uIHRydW5jYXRlRGVjaW1hbHMgKG51bWJlciwgZGlnaXRzKSB7XG4gIGxldCBtdWx0aXBsaWVyID0gTWF0aC5wb3coMTAsIGRpZ2l0cyksXG4gICAgICBhZGp1c3RlZE51bSA9IG51bWJlciAqIG11bHRpcGxpZXIsXG4gICAgICB0cnVuY2F0ZWROdW0gPSBNYXRoW2FkanVzdGVkTnVtIDwgMCA/ICdjZWlsJyA6ICdmbG9vciddKGFkanVzdGVkTnVtKTtcblxuICByZXR1cm4gdHJ1bmNhdGVkTnVtIC8gbXVsdGlwbGllcjtcbn07XG5cbmhlbHBlcnMuaXNDaHJvbWVCcm93c2VyID0gZnVuY3Rpb24gaXNDaHJvbWVCcm93c2VyIChicm93c2VyKSB7XG4gIHJldHVybiBfLmluY2x1ZGVzKE9iamVjdC5rZXlzKENIUk9NRV9CUk9XU0VSX1BBQ0tBR0VfQUNUSVZJVFkpLCAoYnJvd3NlciB8fCAnJykudG9Mb3dlckNhc2UoKSk7XG59O1xuXG5oZWxwZXJzLmdldENocm9tZVBrZyA9IGZ1bmN0aW9uIGdldENocm9tZVBrZyAoYnJvd3Nlcikge1xuICByZXR1cm4gQ0hST01FX0JST1dTRVJfUEFDS0FHRV9BQ1RJVklUWVticm93c2VyLnRvTG93ZXJDYXNlKCldIHx8IENIUk9NRV9CUk9XU0VSX1BBQ0tBR0VfQUNUSVZJVFkuZGVmYXVsdDtcbn07XG5cbmhlbHBlcnMucmVtb3ZlQWxsU2Vzc2lvbldlYlNvY2tldEhhbmRsZXJzID0gYXN5bmMgZnVuY3Rpb24gcmVtb3ZlQWxsU2Vzc2lvbldlYlNvY2tldEhhbmRsZXJzIChzZXJ2ZXIsIHNlc3Npb25JZCkge1xuICBpZiAoIXNlcnZlciB8fCAhXy5pc0Z1bmN0aW9uKHNlcnZlci5nZXRXZWJTb2NrZXRIYW5kbGVycykpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBhY3RpdmVIYW5kbGVycyA9IGF3YWl0IHNlcnZlci5nZXRXZWJTb2NrZXRIYW5kbGVycyhzZXNzaW9uSWQpO1xuICBmb3IgKGNvbnN0IHBhdGhuYW1lIG9mIF8ua2V5cyhhY3RpdmVIYW5kbGVycykpIHtcbiAgICBhd2FpdCBzZXJ2ZXIucmVtb3ZlV2ViU29ja2V0SGFuZGxlcihwYXRobmFtZSk7XG4gIH1cbn07XG5cbi8qKlxuICogVGFrZXMgYSBkZXNpcmVkIGNhcGFiaWxpdHkgYW5kIHRyaWVzIHRvIEpTT04ucGFyc2UgaXQgYXMgYW4gYXJyYXksXG4gKiBhbmQgZWl0aGVyIHJldHVybnMgdGhlIHBhcnNlZCBhcnJheSBvciBhIHNpbmdsZXRvbiBhcnJheS5cbiAqXG4gKiBAcGFyYW0ge2FueX0gY2FwIEEgZGVzaXJlZCBjYXBhYmlsaXR5XG4gKi9cbmhlbHBlcnMucGFyc2VBcnJheSA9IGZ1bmN0aW9uIHBhcnNlQXJyYXkgKGNhcCkge1xuICBsZXQgcGFyc2VkQ2FwcztcbiAgdHJ5IHtcbiAgICBwYXJzZWRDYXBzID0gSlNPTi5wYXJzZShjYXApO1xuICB9IGNhdGNoIChpZ24pIHsgfVxuXG4gIGlmIChfLmlzQXJyYXkocGFyc2VkQ2FwcykpIHtcbiAgICByZXR1cm4gcGFyc2VkQ2FwcztcbiAgfSBlbHNlIGlmIChfLmlzU3RyaW5nKGNhcCkpIHtcbiAgICByZXR1cm4gW2NhcF07XG4gIH1cblxuICB0aHJvdyBuZXcgRXJyb3IoYG11c3QgcHJvdmlkZSBhIHN0cmluZyBvciBKU09OIEFycmF5OyByZWNlaXZlZCAke2NhcH1gKTtcbn07XG5cbi8qKlxuICogVmFsaWRhdGUgZGVzaXJlZCBjYXBhYmlsaXRpZXMuIFJldHVybnMgdHJ1ZSBpZiBjYXBhYmlsaXR5IGlzIHZhbGlkXG4gKlxuICogQHBhcmFtIHsqfSBjYXAgQSBkZXNpcmVkIGNhcGFiaWxpdHlcbiAqIEByZXR1cm4ge2Jvb2xlYW59IFJldHVybnMgdHJ1ZSBpZiB0aGUgY2FwYWJpbGl0eSBpcyB2YWxpZFxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBjYXBzIGhhcyBpbnZhbGlkIGNhcGFiaWxpdHlcbiAqL1xuaGVscGVycy52YWxpZGF0ZURlc2lyZWRDYXBzID0gZnVuY3Rpb24gdmFsaWRhdGVEZXNpcmVkQ2FwcyAoY2Fwcykge1xuICBpZiAoY2Fwcy5icm93c2VyTmFtZSkge1xuICAgIGlmIChjYXBzLmFwcCkge1xuICAgICAgLy8gd2FybiBpZiB0aGUgY2FwYWJpbGl0aWVzIGhhdmUgYm90aCBgYXBwYCBhbmQgYGJyb3dzZXIsIGFsdGhvdWdoIHRoaXMgaXMgY29tbW9uIHdpdGggc2VsZW5pdW0gZ3JpZFxuICAgICAgbG9nZ2VyLndhcm4oYFRoZSBkZXNpcmVkIGNhcGFiaWxpdGllcyBzaG91bGQgZ2VuZXJhbGx5IG5vdCBpbmNsdWRlIGJvdGggYW4gJ2FwcCcgYW5kIGEgJ2Jyb3dzZXJOYW1lJ2ApO1xuICAgIH1cbiAgICBpZiAoY2Fwcy5hcHBQYWNrYWdlKSB7XG4gICAgICBsb2dnZXIuZXJyb3JBbmRUaHJvdyhgVGhlIGRlc2lyZWQgc2hvdWxkIG5vdCBpbmNsdWRlIGJvdGggb2YgYW4gJ2FwcFBhY2thZ2UnIGFuZCBhICdicm93c2VyTmFtZSdgKTtcbiAgICB9XG4gIH1cblxuICBpZiAoY2Fwcy51bmluc3RhbGxPdGhlclBhY2thZ2VzKSB7XG4gICAgdHJ5IHtcbiAgICAgIHRoaXMucGFyc2VBcnJheShjYXBzLnVuaW5zdGFsbE90aGVyUGFja2FnZXMpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvZ2dlci5lcnJvckFuZFRocm93KGBDb3VsZCBub3QgcGFyc2UgXCJ1bmluc3RhbGxPdGhlclBhY2thZ2VzXCIgY2FwYWJpbGl0eTogJHtlLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59O1xuXG4vKipcbiAqIEFkanVzdCB0aGUgY2FwYWJpbGl0aWVzIGZvciBhIGJyb3dzZXIgc2Vzc2lvblxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBjYXBzIC0gQ3VycmVudCBjYXBhYmlsaXRpZXMgb2JqZWN0XG4gKiAhISEgVGhlIG9iamVjdCBpcyBtdXRhdGVkIGJ5IHRoaXMgbWV0aG9kIGNhbGwgISEhXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBUaGUgc2FtZSBwb3NzaWJseSBtdXRhdGVkIGBvcHRzYCBpbnN0YW5jZS5cbiAqIE5vIG11dGF0aW9uIGlzIGhhcHBlbmluZyBpcyB0aGUgY3VycmVudCBzZXNzaW9uIGlmXG4gKiBhcHBQYWNrYWdlL2FwcEFjdGl2aXR5IGNhcHMgaGF2ZSBhbHJlYWR5IGJlZW4gcHJvdmlkZWQuXG4gKi9cbmhlbHBlcnMuYWRqdXN0QnJvd3NlclNlc3Npb25DYXBzID0gZnVuY3Rpb24gYWRqdXN0QnJvd3NlclNlc3Npb25DYXBzIChjYXBzID0ge30pIHtcbiAgY29uc3QgeyBicm93c2VyTmFtZSB9ID0gY2FwcztcbiAgbG9nZ2VyLmluZm8oYFRoZSBjdXJyZW50IHNlc3Npb24gaXMgY29uc2lkZXJlZCBicm93c2VyLWJhc2VkYCk7XG4gIGxvZ2dlci5pbmZvKGBTdXBwb3J0ZWQgYnJvd3NlciBuYW1lczogJHtKU09OLnN0cmluZ2lmeShfLmtleXMoQ0hST01FX0JST1dTRVJfUEFDS0FHRV9BQ1RJVklUWSkpfWApO1xuICBpZiAoY2Fwcy5hcHBQYWNrYWdlIHx8IGNhcHMuYXBwQWN0aXZpdHkpIHtcbiAgICBsb2dnZXIuaW5mbyhgTm90IG92ZXJyaWRpbmcgYXBwUGFja2FnZS9hcHBBY3Rpdml0eSBjYXBhYmlsaXR5IHZhbHVlcyBmb3IgJyR7YnJvd3Nlck5hbWV9JyBgICtcbiAgICAgICdiZWNhdXNlIHNvbWUgb2YgdGhlbSBoYXZlIGJlZW4gYWxyZWFkeSBwcm92aWRlZCcpO1xuICAgIHJldHVybiBjYXBzO1xuICB9XG5cbiAgY29uc3Qge3BrZywgYWN0aXZpdHl9ID0gdGhpcy5nZXRDaHJvbWVQa2coYnJvd3Nlck5hbWUpO1xuICBjYXBzLmFwcFBhY2thZ2UgPSBwa2c7XG4gIGNhcHMuYXBwQWN0aXZpdHkgPSBhY3Rpdml0eTtcbiAgbG9nZ2VyLmluZm8oYGFwcFBhY2thZ2UvYXBwQWN0aXZpdHkgY2FwYWJpbGl0aWVzIGhhdmUgYmVlbiBhdXRvbWF0aWNhbGx5IHNldCB0byAke3BrZ30vJHthY3Rpdml0eX0gYCArXG4gICAgYGZvciAnJHticm93c2VyTmFtZX0nYCk7XG4gIGxvZ2dlci5pbmZvKGBDb25zaWRlciBjaGFuZ2luZyB0aGUgYnJvd3Nlck5hbWUgdG8gdGhlIG9uZSBmcm9tIHRoZSBsaXN0IG9mIHN1cHBvcnRlZCBicm93c2VyIG5hbWVzIGAgK1xuICAgIGBvciBwcm92aWRlIGN1c3RvbSBhcHBQYWNrYWdlL2FwcEFjdGl2aXR5IGNhcGFiaWxpdHkgdmFsdWVzIGlmIHRoZSBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIG9uZXMgZG8gYCArXG4gICAgYG5vdCBtYWtlIHNlbnNlYCk7XG4gIHJldHVybiBjYXBzO1xufTtcblxuLyoqXG4gKiBDaGVja3Mgd2hldGhlciB0aGUgY3VycmVudCBkZXZpY2UgdW5kZXIgdGVzdCBpcyBhbiBlbXVsYXRvclxuICpcbiAqIEBwYXJhbSB7QURCfSBhZGIgLSBhcHBpdW0tYWRiIGluc3RhbmNlXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0cyAtIGRyaXZlciBvcHRpb25zIG1hcHBpbmdcbiAqIEByZXR1cm5zIHtib29sZWFufSBgdHJ1ZWAgaWYgdGhlIGRldmljZSBpcyBhbiBBbmRyb2lkIGVtdWxhdG9yXG4gKi9cbmhlbHBlcnMuaXNFbXVsYXRvciA9IGZ1bmN0aW9uIGlzRW11bGF0b3IgKGFkYiwgb3B0cykge1xuICBjb25zdCBwb3NzaWJsZU5hbWVzID0gW29wdHMudWRpZCwgYWRiPy5jdXJEZXZpY2VJZF07XG4gIHJldHVybiAhIW9wdHMuYXZkIHx8IHBvc3NpYmxlTmFtZXMuc29tZSgoeCkgPT4gRU1VTEFUT1JfUEFUVEVSTi50ZXN0KHgpKTtcbn07XG5cbmhlbHBlcnMuYm9vdHN0cmFwID0gQm9vdHN0cmFwO1xuaGVscGVycy51bmxvY2tlciA9IHVubG9ja2VyO1xuXG5leHBvcnQgeyBoZWxwZXJzLCBTRVRUSU5HU19IRUxQRVJfUEtHX0lELCBBUFBfU1RBVEUsIHByZXBhcmVBdmRBcmdzLCBlbnN1cmVOZXR3b3JrU3BlZWQgfTtcbmV4cG9ydCBkZWZhdWx0IGhlbHBlcnM7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBSUE7O0FB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